<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Digital Soil Mapping and Modeling | DRAFT - Integrated soil information for decision-making </title>
  <meta name="description" content="SoilFER SID Technical Manual" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Digital Soil Mapping and Modeling | DRAFT - Integrated soil information for decision-making " />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="SoilFER SID Technical Manual" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Digital Soil Mapping and Modeling | DRAFT - Integrated soil information for decision-making " />
  
  <meta name="twitter:description" content="SoilFER SID Technical Manual" />
  

<meta name="author" content="Angelini, M.E., Rodriguez Lado, L., de Sousa Mendes, W., Ribeiro, E., Luotto, I." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="glosis-soil-data-preparation.html"/>
<link rel="next" href="soil-data-sharing.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Licence</a></li>
<li class="chapter" data-level="" data-path="abbreviations-and-acronyms.html"><a href="abbreviations-and-acronyms.html"><i class="fa fa-check"></i>Abbreviations and acronyms</a></li>
<li class="chapter" data-level="" data-path="contributors-and-reviewers.html"><a href="contributors-and-reviewers.html"><i class="fa fa-check"></i>Contributors and reviewers</a></li>
<li class="chapter" data-level="" data-path="presentation-and-basics.html"><a href="presentation-and-basics.html"><i class="fa fa-check"></i>Presentation and basics</a>
<ul>
<li class="chapter" data-level="" data-path="presentation-and-basics.html"><a href="presentation-and-basics.html#background-and-objective"><i class="fa fa-check"></i>Background and Objective</a></li>
<li class="chapter" data-level="" data-path="presentation-and-basics.html"><a href="presentation-and-basics.html#what-this-tutorial-is-not"><i class="fa fa-check"></i>What this Tutorial is not</a></li>
<li class="chapter" data-level="" data-path="presentation-and-basics.html"><a href="presentation-and-basics.html#the-training-dataset"><i class="fa fa-check"></i>The Training Dataset</a>
<ul>
<li class="chapter" data-level="" data-path="presentation-and-basics.html"><a href="presentation-and-basics.html#data-structure"><i class="fa fa-check"></i>Data Structure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation-and-basics.html"><a href="presentation-and-basics.html#how-to-use-this-manual"><i class="fa fa-check"></i>How to Use This Manual</a>
<ul>
<li class="chapter" data-level="" data-path="presentation-and-basics.html"><a href="presentation-and-basics.html#manual-structure"><i class="fa fa-check"></i>Manual Structure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation-and-basics.html"><a href="presentation-and-basics.html#required-downloads"><i class="fa fa-check"></i>Required downloads</a>
<ul>
<li class="chapter" data-level="" data-path="presentation-and-basics.html"><a href="presentation-and-basics.html#step-by-step-setup-instructions"><i class="fa fa-check"></i>Step-by-step setup instructions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html"><i class="fa fa-check"></i>Introduction to R programming</a>
<ul>
<li class="chapter" data-level="0.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#what-is-r"><i class="fa fa-check"></i><b>0.1</b> What is R?</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#why-r-for-soil-science"><i class="fa fa-check"></i><b>0.1.1</b> Why R for Soil Science?</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>0.2</b> Installing R and RStudio</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#installing-r"><i class="fa fa-check"></i><b>0.2.1</b> Installing R</a></li>
<li class="chapter" data-level="0.2.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#installing-rstudio"><i class="fa fa-check"></i><b>0.2.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="0.2.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#verifying-installation"><i class="fa fa-check"></i><b>0.2.3</b> Verifying Installation</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#understanding-the-rstudio-interface"><i class="fa fa-check"></i><b>0.3</b> Understanding the RStudio Interface</a>
<ul>
<li class="chapter" data-level="0.3.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#console-pane-bottom-left"><i class="fa fa-check"></i><b>0.3.1</b> 1. Console Pane (Bottom Left)</a></li>
<li class="chapter" data-level="0.3.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#code-editor-pane-top-left"><i class="fa fa-check"></i><b>0.3.2</b> 2. Code Editor Pane (Top Left)</a></li>
<li class="chapter" data-level="0.3.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#environmenthistory-pane-top-right"><i class="fa fa-check"></i><b>0.3.3</b> 3. Environment/History Pane (Top Right)</a></li>
<li class="chapter" data-level="0.3.4" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#filesplotspackageshelp-pane-bottom-right"><i class="fa fa-check"></i><b>0.3.4</b> 4. Files/Plots/Packages/Help Pane (Bottom Right)</a></li>
</ul></li>
<li class="chapter" data-level="0.4" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#r-packages-extending-rs-capabilities"><i class="fa fa-check"></i><b>0.4</b> R Packages: Extending R’s Capabilities</a>
<ul>
<li class="chapter" data-level="0.4.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#what-are-packages"><i class="fa fa-check"></i><b>0.4.1</b> What are Packages?</a></li>
<li class="chapter" data-level="0.4.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#installing-packages"><i class="fa fa-check"></i><b>0.4.2</b> Installing Packages</a></li>
<li class="chapter" data-level="0.4.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#loading-packages"><i class="fa fa-check"></i><b>0.4.3</b> Loading Packages</a></li>
<li class="chapter" data-level="0.4.4" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#finding-help-on-packages"><i class="fa fa-check"></i><b>0.4.4</b> Finding Help on Packages</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#object-types"><i class="fa fa-check"></i><b>0.5</b> R Basics: Objects and Data Types</a>
<ul>
<li class="chapter" data-level="0.5.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#object-assignment"><i class="fa fa-check"></i><b>0.5.1</b> Creating Objects with Assignment</a></li>
<li class="chapter" data-level="0.5.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#data-types"><i class="fa fa-check"></i><b>0.5.2</b> Data Types in R</a></li>
<li class="chapter" data-level="0.5.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#check-data"><i class="fa fa-check"></i><b>0.5.3</b> Checking Data Types</a></li>
</ul></li>
<li class="chapter" data-level="0.6" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#structure-data"><i class="fa fa-check"></i><b>0.6</b> Data Structures in R</a>
<ul>
<li class="chapter" data-level="0.6.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#vector-data"><i class="fa fa-check"></i><b>0.6.1</b> Vectors</a></li>
<li class="chapter" data-level="0.6.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#factor-data"><i class="fa fa-check"></i><b>0.6.2</b> Factors</a></li>
<li class="chapter" data-level="0.6.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#matrix-data"><i class="fa fa-check"></i><b>0.6.3</b> Matrices</a></li>
<li class="chapter" data-level="0.6.4" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#dataframe"><i class="fa fa-check"></i><b>0.6.4</b> Data Frames</a></li>
<li class="chapter" data-level="0.6.5" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#list-data"><i class="fa fa-check"></i><b>0.6.5</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#operators"><i class="fa fa-check"></i><b>0.7</b> Operators in R</a>
<ul>
<li class="chapter" data-level="0.7.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#arithmetic-operators"><i class="fa fa-check"></i><b>0.7.1</b> Arithmetic Operators</a></li>
<li class="chapter" data-level="0.7.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#comparison-operators"><i class="fa fa-check"></i><b>0.7.2</b> Comparison Operators</a></li>
<li class="chapter" data-level="0.7.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#logical-operators"><i class="fa fa-check"></i><b>0.7.3</b> Logical Operators</a></li>
</ul></li>
<li class="chapter" data-level="0.8" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#conditional-statements"><i class="fa fa-check"></i><b>0.8</b> Control Structures: Conditional Statements</a>
<ul>
<li class="chapter" data-level="0.8.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#ifelse-statements"><i class="fa fa-check"></i><b>0.8.1</b> If-Else Statements</a></li>
<li class="chapter" data-level="0.8.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#v-ifelse-statements"><i class="fa fa-check"></i><b>0.8.2</b> Vectorized If-Else: <code>ifelse()</code></a></li>
<li class="chapter" data-level="0.8.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#cut-statements"><i class="fa fa-check"></i><b>0.8.3</b> Vectorized Cut: <code>cut()</code></a></li>
</ul></li>
<li class="chapter" data-level="0.9" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#control-structures"><i class="fa fa-check"></i><b>0.9</b> Control Structures: Loops</a>
<ul>
<li class="chapter" data-level="0.9.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#for-loop"><i class="fa fa-check"></i><b>0.9.1</b> For Loops</a></li>
<li class="chapter" data-level="0.9.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#while-loop"><i class="fa fa-check"></i><b>0.9.2</b> While Loops</a></li>
</ul></li>
<li class="chapter" data-level="0.10" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#r-funtions"><i class="fa fa-check"></i><b>0.10</b> Functions in R</a>
<ul>
<li class="chapter" data-level="0.10.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#built-funtions"><i class="fa fa-check"></i><b>0.10.1</b> Using Built-in Functions</a></li>
<li class="chapter" data-level="0.10.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#build-functions"><i class="fa fa-check"></i><b>0.10.2</b> Creating Custom Functions</a></li>
<li class="chapter" data-level="0.10.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#arguments-functions"><i class="fa fa-check"></i><b>0.10.3</b> Function Arguments and Defaults</a></li>
</ul></li>
<li class="chapter" data-level="0.11" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#R-data-manipulation"><i class="fa fa-check"></i><b>0.11</b> Data Manipulation with Base R</a>
<ul>
<li class="chapter" data-level="0.11.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#R-data-subset"><i class="fa fa-check"></i><b>0.11.1</b> Subsetting and Filtering</a></li>
<li class="chapter" data-level="0.11.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#delete-cols"><i class="fa fa-check"></i><b>0.11.2</b> Deleting Columns</a></li>
<li class="chapter" data-level="0.11.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#sort-rows"><i class="fa fa-check"></i><b>0.11.3</b> Sorting Data</a></li>
<li class="chapter" data-level="0.11.4" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#aggregate-rows"><i class="fa fa-check"></i><b>0.11.4</b> Aggregating Data</a></li>
</ul></li>
<li class="chapter" data-level="0.12" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#tidyverse-manipultation"><i class="fa fa-check"></i><b>0.12</b> Data Manipulation with the Tidyverse</a>
<ul>
<li class="chapter" data-level="0.12.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#tidyverse-load"><i class="fa fa-check"></i><b>0.12.1</b> Loading the Tidyverse</a></li>
<li class="chapter" data-level="0.12.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#tidyverse-tibbles"><i class="fa fa-check"></i><b>0.12.2</b> Tibbles: Modern Data Frames</a></li>
<li class="chapter" data-level="0.12.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#tidyverse-pipe"><i class="fa fa-check"></i><b>0.12.3</b> The Pipe Operator: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="0.12.4" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#manipulation-dplyr"><i class="fa fa-check"></i><b>0.12.4</b> Data Manipulation with <code>{dplyr}</code></a></li>
<li class="chapter" data-level="0.12.5" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#dplyr-rename"><i class="fa fa-check"></i><b>0.12.5</b> Renaming Columns with <code>rename()</code></a></li>
<li class="chapter" data-level="0.12.6" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#dplyr-group"><i class="fa fa-check"></i><b>0.12.6</b> Grouping and Summarizing Data by columns</a></li>
</ul></li>
<li class="chapter" data-level="0.13" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#dplyr-join"><i class="fa fa-check"></i><b>0.13</b> Combining Data Frames</a>
<ul>
<li class="chapter" data-level="0.13.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#understand-joins"><i class="fa fa-check"></i><b>0.13.1</b> Understanding Joins</a></li>
<li class="chapter" data-level="0.13.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#dplyr-bind_rows"><i class="fa fa-check"></i><b>0.13.2</b> Stacking Data with <code>bind_rows()</code></a></li>
</ul></li>
<li class="chapter" data-level="0.14" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#NA"><i class="fa fa-check"></i><b>0.14</b> Missing Data</a>
<ul>
<li class="chapter" data-level="0.14.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#identify-NA"><i class="fa fa-check"></i><b>0.14.1</b> Identifying Missing Data</a></li>
<li class="chapter" data-level="0.14.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#handle-NA"><i class="fa fa-check"></i><b>0.14.2</b> Handling Missing Data</a></li>
</ul></li>
<li class="chapter" data-level="0.15" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#pivoting"><i class="fa fa-check"></i><b>0.15</b> Data Reshaping with <code>{tidyr}</code> package: Pivoting</a></li>
<li class="chapter" data-level="0.16" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#dl-data"><i class="fa fa-check"></i><b>0.16</b> Handling Below Detection Limit Data</a></li>
<li class="chapter" data-level="0.17" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#soil-data"><i class="fa fa-check"></i><b>0.17</b> Working with Soil Data</a>
<ul>
<li class="chapter" data-level="0.17.1" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#set-directory"><i class="fa fa-check"></i><b>0.17.1</b> Setting Working Directory</a></li>
<li class="chapter" data-level="0.17.2" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#load-packages"><i class="fa fa-check"></i><b>0.17.2</b> Load packages</a></li>
<li class="chapter" data-level="0.17.3" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#import-files"><i class="fa fa-check"></i><b>0.17.3</b> Importing Data from Files</a></li>
<li class="chapter" data-level="0.17.4" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#data-exploration"><i class="fa fa-check"></i><b>0.17.4</b> Exploring the Data</a></li>
</ul></li>
<li class="chapter" data-level="0.18" data-path="introduction-to-r-programming.html"><a href="introduction-to-r-programming.html#references-m1"><i class="fa fa-check"></i><b>0.18</b> References</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html"><i class="fa fa-check"></i><b>1</b> Data preparation for Digital Soil Mapping in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#introduction-1"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#loading-data"><i class="fa fa-check"></i><b>1.2</b> Loading and exploring raw soil data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#basic-data-loading-and-structure"><i class="fa fa-check"></i><b>1.2.1</b> Basic data loading and structure</a></li>
<li class="chapter" data-level="1.2.2" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#data-components-and-organization"><i class="fa fa-check"></i><b>1.2.2</b> Data components and organization</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#site-data-preparation"><i class="fa fa-check"></i><b>1.3</b> Preparing site data for analysis</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#adding-a-unique-row-identifier"><i class="fa fa-check"></i><b>1.3.1</b> Adding a unique row identifier</a></li>
<li class="chapter" data-level="1.3.2" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#extracting-and-standardizing-column-names-for-sites"><i class="fa fa-check"></i><b>1.3.2</b> Extracting and standardizing column names for sites</a></li>
<li class="chapter" data-level="1.3.3" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#creating-unique-profile-identifiers"><i class="fa fa-check"></i><b>1.3.3</b> Creating unique profile identifiers</a></li>
<li class="chapter" data-level="1.3.4" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#remove-exact-duplicate-site-records"><i class="fa fa-check"></i><b>1.3.4</b> Remove exact duplicate site records</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#coordinate-validation"><i class="fa fa-check"></i><b>1.4</b> Coordinate validation and correction</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-1-missing-coordinates"><i class="fa fa-check"></i><b>1.4.1</b> Check 1: Missing coordinates</a></li>
<li class="chapter" data-level="1.4.2" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-2-valid-coordinate-ranges"><i class="fa fa-check"></i><b>1.4.2</b> Check 2: Valid coordinate ranges</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#depth-validation"><i class="fa fa-check"></i><b>1.5</b> Soil depth validation and correction</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-1-missing-depth-boundaries"><i class="fa fa-check"></i><b>1.5.1</b> Check 1: Missing depth boundaries</a></li>
<li class="chapter" data-level="1.5.2" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-2-negative-depth-values"><i class="fa fa-check"></i><b>1.5.2</b> Check 2: Negative depth values</a></li>
<li class="chapter" data-level="1.5.3" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-3-zero-thickness-intervals"><i class="fa fa-check"></i><b>1.5.3</b> Check 3: Zero-thickness intervals</a></li>
<li class="chapter" data-level="1.5.4" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-4-invalid-depth-logic"><i class="fa fa-check"></i><b>1.5.4</b> Check 4: Invalid depth logic</a></li>
<li class="chapter" data-level="1.5.5" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-5-profiles-without-a-surface-horizon-top-0"><i class="fa fa-check"></i><b>1.5.5</b> Check 5: Profiles without a surface horizon (top &gt; 0)</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#lab-validation"><i class="fa fa-check"></i><b>1.6</b> Preparing lab data: harmonization and validation</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#prepare-and-standardize-laboratory-columns"><i class="fa fa-check"></i><b>1.6.1</b> Prepare and standardize laboratory columns</a></li>
<li class="chapter" data-level="1.6.2" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-1-check-each-property-against-feasible-analytical-thresholds"><i class="fa fa-check"></i><b>1.6.2</b> Check 1: Check each property against feasible analytical thresholds</a></li>
<li class="chapter" data-level="1.6.3" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-2-texture-validation"><i class="fa fa-check"></i><b>1.6.3</b> Check 2: Texture validation</a></li>
<li class="chapter" data-level="1.6.4" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-3-correction-of-out-of-bounds-laboratory-values"><i class="fa fa-check"></i><b>1.6.4</b> Check 3: Correction of out-of-bounds laboratory values</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#duplicate-detection"><i class="fa fa-check"></i><b>1.7</b> Resolving duplicated data in soil profiles</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#why-duplicates-occur"><i class="fa fa-check"></i><b>1.7.1</b> Why duplicates occur</a></li>
<li class="chapter" data-level="1.7.2" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#types-of-duplicate-situations"><i class="fa fa-check"></i><b>1.7.2</b> Types of duplicate situations</a></li>
<li class="chapter" data-level="1.7.3" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#check-1-detect-potential-horizon-duplicates-within-profiles"><i class="fa fa-check"></i><b>1.7.3</b> Check 1: Detect potential horizon duplicates within profiles</a></li>
<li class="chapter" data-level="1.7.4" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#resolving-profile-duplicates"><i class="fa fa-check"></i><b>1.7.4</b> Resolving Profile Duplicates</a></li>
<li class="chapter" data-level="1.7.5" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#remove-profiles-not-starting-at-the-surface"><i class="fa fa-check"></i><b>1.7.5</b> Remove profiles not starting at the surface</a></li>
<li class="chapter" data-level="1.7.6" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#result"><i class="fa fa-check"></i><b>1.7.6</b> Result</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#harmonization"><i class="fa fa-check"></i><b>1.8</b> Harmonizing data for DSM</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#depth-standardization"><i class="fa fa-check"></i><b>1.8.1</b> Depth standardization</a></li>
<li class="chapter" data-level="1.8.2" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#processing-standardized-data"><i class="fa fa-check"></i><b>1.8.2</b> Processing standardized data</a></li>
<li class="chapter" data-level="1.8.3" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#exporting-standardized-data-for-digital-soil-mapping"><i class="fa fa-check"></i><b>1.8.3</b> Exporting standardized data for Digital Soil Mapping</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#spectroscopy"><i class="fa fa-check"></i><b>1.9</b> Preparing data for spectroscopy analyses</a></li>
<li class="chapter" data-level="1.10" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#exports"><i class="fa fa-check"></i><b>1.10</b> Summary of exported files</a></li>
<li class="chapter" data-level="" data-path="data-preparation-for-digital-soil-mapping-in-r.html"><a href="data-preparation-for-digital-soil-mapping-in-r.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html"><i class="fa fa-check"></i><b>2</b> Spatial Analysis in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#spatial-data-concepts"><i class="fa fa-check"></i><b>2.1</b> Spatial Data Concepts</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#vector-vs-raster-data"><i class="fa fa-check"></i><b>2.1.1</b> Vector vs Raster Data</a></li>
<li class="chapter" data-level="2.1.2" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#coordinate-reference-systems-crs-and-projections"><i class="fa fa-check"></i><b>2.1.2</b> Coordinate Reference Systems (CRS) and Projections</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#spatial-packages-in-r-sf-and-terra"><i class="fa fa-check"></i><b>2.2</b> <strong>Spatial Packages in R: <code>{sf}</code> and <code>{terra}</code></strong></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#installing-and-loading-spatial-packages"><i class="fa fa-check"></i><b>2.2.1</b> Installing and Loading Spatial Packages</a></li>
<li class="chapter" data-level="2.2.2" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#working-with-vector-data-using-sf"><i class="fa fa-check"></i><b>2.2.2</b> <strong>Working with Vector Data using <code>{sf}</code></strong></a></li>
<li class="chapter" data-level="2.2.3" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#importing-vector-data"><i class="fa fa-check"></i><b>2.2.3</b> Importing Vector Data</a></li>
<li class="chapter" data-level="2.2.4" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#spatial-relationships-and-joins"><i class="fa fa-check"></i><b>2.2.4</b> Spatial Relationships and Joins</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#working-with-raster-data-using-terra"><i class="fa fa-check"></i><b>2.3</b> <strong>Working with Raster Data using <code>{terra}</code></strong></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#importing-raster-data"><i class="fa fa-check"></i><b>2.3.1</b> Importing Raster Data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#combining-vector-and-raster-data"><i class="fa fa-check"></i><b>2.4</b> Combining Vector and Raster Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#extracting-raster-values-to-points-and-polygons"><i class="fa fa-check"></i><b>2.4.1</b> Extracting Raster Values to Points and Polygons</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#exporting-and-sharing-spatial-data"><i class="fa fa-check"></i><b>2.5</b> Exporting and Sharing Spatial Data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#exporting-vector-data"><i class="fa fa-check"></i><b>2.5.1</b> Exporting Vector Data</a></li>
<li class="chapter" data-level="2.5.2" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#exporting-raster-data"><i class="fa fa-check"></i><b>2.5.2</b> Exporting Raster Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html"><i class="fa fa-check"></i><b>3</b> Sampling design for soil surveys</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#sampling-theory"><i class="fa fa-check"></i><b>3.2</b> Sampling methodologies for soil spatial survey</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#selection-methods"><i class="fa fa-check"></i><b>3.2.1</b> Selection of the sampling methodology</a></li>
<li class="chapter" data-level="3.2.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#inference-methods"><i class="fa fa-check"></i><b>3.2.2</b> Inference Methods</a></li>
<li class="chapter" data-level="3.2.3" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#sampling-purpose"><i class="fa fa-check"></i><b>3.2.3</b> Purpose of Sampling</a></li>
<li class="chapter" data-level="3.2.4" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#design-types"><i class="fa fa-check"></i><b>3.2.4</b> Sampling Design Types</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#soilfer-design"><i class="fa fa-check"></i><b>3.3</b> SoilFER Sampling Design</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#soil-properties"><i class="fa fa-check"></i><b>3.3.1</b> Soil Properties</a></li>
<li class="chapter" data-level="3.3.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#env-covariates"><i class="fa fa-check"></i><b>3.3.2</b> Environmental Covariates</a></li>
<li class="chapter" data-level="3.3.3" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#methodology"><i class="fa fa-check"></i><b>3.3.3</b> Understanding the Methodology</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#tutorial"><i class="fa fa-check"></i><b>3.4</b> Tutorial Using R</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#setup"><i class="fa fa-check"></i><b>3.4.1</b> Setting Up the Environment</a></li>
<li class="chapter" data-level="3.4.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#define-parameters"><i class="fa fa-check"></i><b>3.4.2</b> Define Variables and Parameters</a></li>
<li class="chapter" data-level="3.4.3" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#country-iso-code"><i class="fa fa-check"></i><b>3.4.3</b> Country ISO Code</a></li>
<li class="chapter" data-level="3.4.4" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#custom-functions"><i class="fa fa-check"></i><b>3.4.4</b> Custom Functions</a></li>
<li class="chapter" data-level="3.4.5" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#load-boundaries"><i class="fa fa-check"></i><b>3.4.5</b> Load Country Boundaries and Legacy Data</a></li>
<li class="chapter" data-level="3.4.6" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#load-covariates-psu"><i class="fa fa-check"></i><b>3.4.6</b> Load Environmental Covariates for PSUs</a></li>
<li class="chapter" data-level="3.4.7" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#load-main-environmental-covariates"><i class="fa fa-check"></i><b>3.4.7</b> Load Main Environmental Covariates</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#pca"><i class="fa fa-check"></i><b>3.5</b> Principal Component Analysis (PCA)</a></li>
<li class="chapter" data-level="3.6" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#sampling-universe"><i class="fa fa-check"></i><b>3.6</b> Organize the Sampling Universe</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#load-and-process-land-use-data"><i class="fa fa-check"></i><b>3.6.1</b> Load and Process Land Use Data</a></li>
<li class="chapter" data-level="3.6.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#exclude-protected-areas"><i class="fa fa-check"></i><b>3.6.2</b> Exclude Protected Areas</a></li>
<li class="chapter" data-level="3.6.3" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#restrict-to-accessible-slopes"><i class="fa fa-check"></i><b>3.6.3</b> Restrict to Accessible Slopes</a></li>
<li class="chapter" data-level="3.6.4" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#aggregate-to-100m-resolution"><i class="fa fa-check"></i><b>3.6.4</b> Aggregate to 100m Resolution</a></li>
<li class="chapter" data-level="3.6.5" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#save-processed-land-use"><i class="fa fa-check"></i><b>3.6.5</b> Save Processed Land Use</a></li>
<li class="chapter" data-level="3.6.6" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#filter-legacy-data"><i class="fa fa-check"></i><b>3.6.6</b> Filter Legacy Data</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#create-psu-grid"><i class="fa fa-check"></i><b>3.7</b> Create Primary Sampling Units (PSU Grid)</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#generate-2km-2km-grid"><i class="fa fa-check"></i><b>3.7.1</b> Generate 2km × 2km Grid</a></li>
<li class="chapter" data-level="3.7.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#trim-to-country-boundaries"><i class="fa fa-check"></i><b>3.7.2</b> Trim to Country Boundaries</a></li>
<li class="chapter" data-level="3.7.3" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#save-psu-grid"><i class="fa fa-check"></i><b>3.7.3</b> Save PSU Grid</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#select-psus"><i class="fa fa-check"></i><b>3.8</b> Select PSUs with Sufficient Land Use Coverage</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#calculate-land-use-percentage"><i class="fa fa-check"></i><b>3.8.1</b> Calculate Land Use Percentage</a></li>
<li class="chapter" data-level="3.8.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#filter-psus"><i class="fa fa-check"></i><b>3.8.2</b> Filter PSUs</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#rasterize-psus"><i class="fa fa-check"></i><b>3.9</b> Rasterize PSUs for Covariate Space Coverage</a></li>
<li class="chapter" data-level="3.10" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#optimal-sample-size"><i class="fa fa-check"></i><b>3.10</b> Compute Optimal Sample Size</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#run-optimization"><i class="fa fa-check"></i><b>3.10.1</b> Run Optimization</a></li>
<li class="chapter" data-level="3.10.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#extract-optimal-sample-size"><i class="fa fa-check"></i><b>3.10.2</b> Extract Optimal Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#csc-computing"><i class="fa fa-check"></i><b>3.11</b> Covariate Space Coverage - Computing PSUs</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#prepare-function-parameters"><i class="fa fa-check"></i><b>3.11.1</b> Prepare Function Parameters</a></li>
<li class="chapter" data-level="3.11.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#perform-k-means-clustering"><i class="fa fa-check"></i><b>3.11.2</b> Perform K-means Clustering</a></li>
<li class="chapter" data-level="3.11.3" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#assign-clusters-and-calculate-distances"><i class="fa fa-check"></i><b>3.11.3</b> Assign Clusters and Calculate Distances</a></li>
<li class="chapter" data-level="3.11.4" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#extract-selected-psus"><i class="fa fa-check"></i><b>3.11.4</b> Extract Selected PSUs</a></li>
<li class="chapter" data-level="3.11.5" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#visualize-in-covariate-space"><i class="fa fa-check"></i><b>3.11.5</b> Visualize in Covariate Space</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#compute-ssu-tsu"><i class="fa fa-check"></i><b>3.12</b> Compute SSUs and TSUs</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#load-high-resolution-covariates"><i class="fa fa-check"></i><b>3.12.1</b> Load High-Resolution Covariates</a></li>
<li class="chapter" data-level="3.12.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#process-each-psu"><i class="fa fa-check"></i><b>3.12.2</b> Process Each PSU</a></li>
<li class="chapter" data-level="3.12.3" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#combine-ssus-and-tsus"><i class="fa fa-check"></i><b>3.12.3</b> Combine SSUs and TSUs</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#export-units"><i class="fa fa-check"></i><b>3.13</b> Export Sampling Units</a>
<ul>
<li class="chapter" data-level="3.13.1" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#create-cluster-raster"><i class="fa fa-check"></i><b>3.13.1</b> Create Cluster Raster</a></li>
<li class="chapter" data-level="3.13.2" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#join-cluster-info-to-tsus"><i class="fa fa-check"></i><b>3.13.2</b> Join Cluster Info to TSUs</a></li>
<li class="chapter" data-level="3.13.3" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#create-site-ids"><i class="fa fa-check"></i><b>3.13.3</b> Create Site IDs</a></li>
<li class="chapter" data-level="3.13.4" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#export-shapefiles"><i class="fa fa-check"></i><b>3.13.4</b> Export Shapefiles</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="sampling-design-for-soil-surveys.html"><a href="sampling-design-for-soil-surveys.html#alternative-psus"><i class="fa fa-check"></i><b>3.14</b> Compute Alternative PSUs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="merging-results.html"><a href="merging-results.html"><i class="fa fa-check"></i><b>4</b> Merging Results from Multiple Land Uses</a>
<ul>
<li class="chapter" data-level="4.1" data-path="merging-results.html"><a href="merging-results.html#assign-unique-ids"><i class="fa fa-check"></i><b>4.1</b> Assign Country-Wide Unique IDs</a></li>
<li class="chapter" data-level="4.2" data-path="merging-results.html"><a href="merging-results.html#export-unified"><i class="fa fa-check"></i><b>4.2</b> Export Unified Datasets</a></li>
<li class="chapter" data-level="4.3" data-path="merging-results.html"><a href="merging-results.html#summary-stats"><i class="fa fa-check"></i><b>4.3</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.4" data-path="merging-results.html"><a href="merging-results.html#distribution-maps"><i class="fa fa-check"></i><b>4.4</b> Create Distribution Maps</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="field-protocol.html"><a href="field-protocol.html"><i class="fa fa-check"></i><b>5</b> Field Sampling Protocol</a>
<ul>
<li class="chapter" data-level="5.1" data-path="field-protocol.html"><a href="field-protocol.html#gps-prep"><i class="fa fa-check"></i><b>5.1</b> GPS Device Preparation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="field-protocol.html"><a href="field-protocol.html#export-to-gpx-format"><i class="fa fa-check"></i><b>5.1.1</b> Export to GPX Format</a></li>
<li class="chapter" data-level="5.1.2" data-path="field-protocol.html"><a href="field-protocol.html#load-onto-gps-device"><i class="fa fa-check"></i><b>5.1.2</b> Load onto GPS Device</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="field-protocol.html"><a href="field-protocol.html#sampling-procedure"><i class="fa fa-check"></i><b>5.2</b> Sampling Procedure</a></li>
<li class="chapter" data-level="5.3" data-path="field-protocol.html"><a href="field-protocol.html#data-recording"><i class="fa fa-check"></i><b>5.3</b> Data Recording</a></li>
<li class="chapter" data-level="5.4" data-path="field-protocol.html"><a href="field-protocol.html#qc"><i class="fa fa-check"></i><b>5.4</b> Quality Control</a></li>
<li class="chapter" data-level="5.5" data-path="field-protocol.html"><a href="field-protocol.html#references-sdg1"><i class="fa fa-check"></i><b>5.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendices.html"><a href="appendices.html"><i class="fa fa-check"></i>Appendices</a>
<ul>
<li class="chapter" data-level="" data-path="appendices.html"><a href="appendices.html#appendix-a-software-and-data-sources"><i class="fa fa-check"></i>Appendix A: Software and Data Sources</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="appendices.html"><a href="appendices.html#software-requirements"><i class="fa fa-check"></i><b>5.5.1</b> Software Requirements</a></li>
<li class="chapter" data-level="5.5.2" data-path="appendices.html"><a href="appendices.html#data-sources"><i class="fa fa-check"></i><b>5.5.2</b> Data Sources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendices.html"><a href="appendices.html#appendix-b-troubleshooting-common-issues"><i class="fa fa-check"></i>Appendix B: Troubleshooting Common Issues</a>
<ul>
<li class="chapter" data-level="5.5.3" data-path="appendices.html"><a href="appendices.html#memory-issues"><i class="fa fa-check"></i><b>5.5.3</b> Memory Issues</a></li>
<li class="chapter" data-level="5.5.4" data-path="appendices.html"><a href="appendices.html#crs-misalignment"><i class="fa fa-check"></i><b>5.5.4</b> CRS Misalignment</a></li>
<li class="chapter" data-level="5.5.5" data-path="appendices.html"><a href="appendices.html#empty-geometry"><i class="fa fa-check"></i><b>5.5.5</b> Empty Geometry</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendices.html"><a href="appendices.html#appendix-c-acronyms-and-abbreviations"><i class="fa fa-check"></i>Appendix C: Acronyms and Abbreviations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tbd.html"><a href="tbd.html"><i class="fa fa-check"></i><b>6</b> TBD</a></li>
<li class="chapter" data-level="7" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html"><i class="fa fa-check"></i><b>7</b> GloSIS Soil Data Preparation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#the-glosis-database"><i class="fa fa-check"></i><b>7.2</b> The GloSIS database</a></li>
<li class="chapter" data-level="7.3" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#features-of-interest-understanding-the-xlsx-template"><i class="fa fa-check"></i><b>7.3</b> Features of interest: Understanding the XLSX Template</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#plot-data-sheet"><i class="fa fa-check"></i><b>7.3.1</b> <code>Plot Data</code> Sheet</a></li>
<li class="chapter" data-level="7.3.2" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#profile-data-sheet"><i class="fa fa-check"></i><b>7.3.2</b> <code>Profile Data</code> Sheet</a></li>
<li class="chapter" data-level="7.3.3" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#element-data-sheet"><i class="fa fa-check"></i><b>7.3.3</b> <code>Element Data</code> Sheet</a></li>
<li class="chapter" data-level="7.3.4" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#specimen-data-sheet"><i class="fa fa-check"></i><b>7.3.4</b> <code>Specimen Data</code> Sheet</a></li>
<li class="chapter" data-level="7.3.5" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#procedures-sheet"><i class="fa fa-check"></i><b>7.3.5</b> <code>Procedures</code> Sheet</a></li>
<li class="chapter" data-level="7.3.6" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#metadata-sheet"><i class="fa fa-check"></i><b>7.3.6</b> <code>Metadata</code> Sheet</a></li>
<li class="chapter" data-level="7.3.7" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#original-data-sheet"><i class="fa fa-check"></i><b>7.3.7</b> <code>Original Data</code> Sheet</a></li>
<li class="chapter" data-level="7.3.8" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#glosis-methods-sheet"><i class="fa fa-check"></i><b>7.3.8</b> <code>GloSIS Methods</code> sheet</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#glosis-etl"><i class="fa fa-check"></i><b>7.4</b> GloSIS-ETL</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#glosis-data-harmonization"><i class="fa fa-check"></i><b>7.4.1</b> GloSIS Data Harmonization</a></li>
<li class="chapter" data-level="7.4.2" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#step-1-data-ingestion-variable-mapping"><i class="fa fa-check"></i><b>7.4.2</b> Step 1: Data Ingestion &amp; Variable Mapping</a></li>
<li class="chapter" data-level="7.4.3" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#step-2-quality-check-and-quality-report-generation"><i class="fa fa-check"></i><b>7.4.3</b> Step 2: Quality Check and Quality Report Generation</a></li>
<li class="chapter" data-level="7.4.4" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#step-2a-geographic-data-validation"><i class="fa fa-check"></i><b>7.4.4</b> Step 2a: Geographic Data Validation</a></li>
<li class="chapter" data-level="7.4.5" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#step-2b-soil-depth-validation"><i class="fa fa-check"></i><b>7.4.5</b> Step 2b: Soil Depth Validation</a></li>
<li class="chapter" data-level="7.4.6" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#step-2c-soil-properties-validation"><i class="fa fa-check"></i><b>7.4.6</b> Step 2c: Soil Properties Validation</a></li>
<li class="chapter" data-level="7.4.7" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#step-3-data-correction-and-resubmission"><i class="fa fa-check"></i><b>7.4.7</b> Step 3: Data Correction and Resubmission</a></li>
<li class="chapter" data-level="7.4.8" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#step-4-download-harmonized-data"><i class="fa fa-check"></i><b>7.4.8</b> Step 4: Download Harmonized Data</a></li>
<li class="chapter" data-level="7.4.9" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#glosis-data-standardization"><i class="fa fa-check"></i><b>7.4.9</b> GloSIS Data Standardization</a></li>
<li class="chapter" data-level="7.4.10" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#glosis-data-viewer"><i class="fa fa-check"></i><b>7.4.10</b> GloSIS Data Viewer</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#installation-and-setup-of-the-glosis-etl"><i class="fa fa-check"></i><b>7.5</b> Installation and Setup of the <code>GloSIS-ETL</code></a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#install-docker-desktop"><i class="fa fa-check"></i><b>7.5.1</b> Install Docker Desktop</a></li>
<li class="chapter" data-level="7.5.2" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#install-the-glosis-etl-services"><i class="fa fa-check"></i><b>7.5.2</b> Install the GloSIS-ETL Services</a></li>
<li class="chapter" data-level="7.5.3" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#verify-installation"><i class="fa fa-check"></i><b>7.5.3</b> Verify Installation</a></li>
<li class="chapter" data-level="7.5.4" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#pgadmin"><i class="fa fa-check"></i><b>7.5.4</b> Optional: pgAdmin Web Interface</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#accessing-the-services"><i class="fa fa-check"></i><b>7.6</b> Accessing the Services</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#landing-page"><i class="fa fa-check"></i><b>7.6.1</b> Landing Page</a></li>
<li class="chapter" data-level="7.6.2" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#shiny-application-modules"><i class="fa fa-check"></i><b>7.6.2</b> Shiny Application Modules</a></li>
<li class="chapter" data-level="7.6.3" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#glosis-database"><i class="fa fa-check"></i><b>7.6.3</b> GloSIS Database</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#docker-compose-file"><i class="fa fa-check"></i><b>7.7</b> The <code>docker-compose.yml</code> File</a></li>
<li class="chapter" data-level="7.8" data-path="glosis-soil-data-preparation.html"><a href="glosis-soil-data-preparation.html#env-file"><i class="fa fa-check"></i><b>7.8</b> The <code>.env</code> File</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html"><i class="fa fa-check"></i><b>8</b> Digital Soil Mapping and Modeling</a>
<ul>
<li class="chapter" data-level="" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#part-i-theoretical-foundations"><i class="fa fa-check"></i>Part I: Theoretical Foundations</a></li>
<li class="chapter" data-level="8.1" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#fundamentals-of-digital-soil-mapping"><i class="fa fa-check"></i><b>8.1</b> Fundamentals of Digital Soil Mapping</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#introduction-to-digital-soil-mapping"><i class="fa fa-check"></i><b>8.1.1</b> Introduction to Digital Soil Mapping</a></li>
<li class="chapter" data-level="8.1.2" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#the-scorpan-framework"><i class="fa fa-check"></i><b>8.1.2</b> The SCORPAN Framework</a></li>
<li class="chapter" data-level="8.1.3" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#statistical-theory-for-predictive-soil-mapping"><i class="fa fa-check"></i><b>8.1.3</b> Statistical Theory for Predictive Soil Mapping</a></li>
<li class="chapter" data-level="8.1.4" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#types-of-soil-variables"><i class="fa fa-check"></i><b>8.1.4</b> Types of Soil Variables</a></li>
<li class="chapter" data-level="8.1.5" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#prediction-methods"><i class="fa fa-check"></i><b>8.1.5</b> Prediction Methods</a></li>
<li class="chapter" data-level="8.1.6" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#nonlinearity-and-uncertainty"><i class="fa fa-check"></i><b>8.1.6</b> Nonlinearity and Uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#part-ii-practical-application"><i class="fa fa-check"></i>Part II: Practical Application</a></li>
<li class="chapter" data-level="8.2" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#workflow-overview"><i class="fa fa-check"></i><b>8.2</b> Workflow Overview</a></li>
<li class="chapter" data-level="8.3" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#continuous-modelling-ph"><i class="fa fa-check"></i><b>8.3</b> Continuous Modelling (pH)</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#nature-of-the-variable"><i class="fa fa-check"></i><b>8.3.1</b> Nature of the Variable</a></li>
<li class="chapter" data-level="8.3.2" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#data-and-covariates"><i class="fa fa-check"></i><b>8.3.2</b> Data and Covariates</a></li>
<li class="chapter" data-level="8.3.3" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#feature-selection-boruta"><i class="fa fa-check"></i><b>8.3.3</b> Feature Selection (Boruta)</a></li>
<li class="chapter" data-level="8.3.4" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#model-training"><i class="fa fa-check"></i><b>8.3.4</b> Model Training</a></li>
<li class="chapter" data-level="8.3.5" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#variable-importance"><i class="fa fa-check"></i><b>8.3.5</b> Variable Importance</a></li>
<li class="chapter" data-level="8.3.6" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#validation-metrics"><i class="fa fa-check"></i><b>8.3.6</b> Validation Metrics</a></li>
<li class="chapter" data-level="8.3.7" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#prediction-maps"><i class="fa fa-check"></i><b>8.3.7</b> Prediction Maps</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#nominal-classification-clay_ph_class"><i class="fa fa-check"></i><b>8.4</b> Nominal Classification (Clay_pH_Class)</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#nature-of-the-variable-1"><i class="fa fa-check"></i><b>8.4.1</b> Nature of the Variable</a></li>
<li class="chapter" data-level="8.4.2" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#feature-selection"><i class="fa fa-check"></i><b>8.4.2</b> Feature Selection</a></li>
<li class="chapter" data-level="8.4.3" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#model-training-1"><i class="fa fa-check"></i><b>8.4.3</b> Model Training</a></li>
<li class="chapter" data-level="8.4.4" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#validation"><i class="fa fa-check"></i><b>8.4.4</b> Validation</a></li>
<li class="chapter" data-level="8.4.5" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#prediction-maps-1"><i class="fa fa-check"></i><b>8.4.5</b> Prediction Maps</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#ordinal-modelling-ph_class"><i class="fa fa-check"></i><b>8.5</b> Ordinal Modelling (pH_Class)</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#nature-of-the-variable-2"><i class="fa fa-check"></i><b>8.5.1</b> Nature of the Variable</a></li>
<li class="chapter" data-level="8.5.2" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#ordinal-encoding"><i class="fa fa-check"></i><b>8.5.2</b> Ordinal Encoding</a></li>
<li class="chapter" data-level="8.5.3" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#feature-selection-1"><i class="fa fa-check"></i><b>8.5.3</b> Feature Selection</a></li>
<li class="chapter" data-level="8.5.4" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#model-training-2"><i class="fa fa-check"></i><b>8.5.4</b> Model Training</a></li>
<li class="chapter" data-level="8.5.5" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#validation-1"><i class="fa fa-check"></i><b>8.5.5</b> Validation</a></li>
<li class="chapter" data-level="8.5.6" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#prediction-maps-2"><i class="fa fa-check"></i><b>8.5.6</b> Prediction Maps</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#area-of-applicability-aoa"><i class="fa fa-check"></i><b>8.6</b> Area of Applicability (AOA)</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#why-aoa-is-necessary"><i class="fa fa-check"></i><b>8.6.1</b> Why AOA is Necessary</a></li>
<li class="chapter" data-level="8.6.2" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#dissimilarity-index-di"><i class="fa fa-check"></i><b>8.6.2</b> Dissimilarity Index (DI)</a></li>
<li class="chapter" data-level="8.6.3" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#aoa-binary-mask"><i class="fa fa-check"></i><b>8.6.3</b> AOA Binary Mask</a></li>
<li class="chapter" data-level="8.6.4" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#local-point-density-lpd"><i class="fa fa-check"></i><b>8.6.4</b> Local Point Density (LPD)</a></li>
<li class="chapter" data-level="8.6.5" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#predictions-masked-to-aoa"><i class="fa fa-check"></i><b>8.6.5</b> Predictions Masked to AOA</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#summary"><i class="fa fa-check"></i><b>8.7</b> Summary</a></li>
<li class="chapter" data-level="" data-path="digital-soil-mapping-and-modeling.html"><a href="digital-soil-mapping-and-modeling.html#references-1"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="soil-data-sharing.html"><a href="soil-data-sharing.html"><i class="fa fa-check"></i><b>9</b> Soil Data Sharing</a>
<ul>
<li class="chapter" data-level="9.1" data-path="soil-data-sharing.html"><a href="soil-data-sharing.html#data-sharing-and-export-formats"><i class="fa fa-check"></i><b>9.1</b> Data sharing and export formats</a></li>
<li class="chapter" data-level="9.2" data-path="soil-data-sharing.html"><a href="soil-data-sharing.html#metadata"><i class="fa fa-check"></i><b>9.2</b> Metadata</a></li>
<li class="chapter" data-level="9.3" data-path="soil-data-sharing.html"><a href="soil-data-sharing.html#web-services"><i class="fa fa-check"></i><b>9.3</b> Web Services</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-2.html"><a href="references-2.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p>DRAFT - Integrated soil information for decision-making
<img src="images/frontcover.jpg" style="top:0px;height:100px;" align="right" /></p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="digital-soil-mapping-and-modeling" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Digital Soil Mapping and Modeling<a href="digital-soil-mapping-and-modeling.html#digital-soil-mapping-and-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="part-i-theoretical-foundations" class="section level2 unnumbered hasAnchor">
<h2>Part I: Theoretical Foundations<a href="digital-soil-mapping-and-modeling.html#part-i-theoretical-foundations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
</div>
<div id="fundamentals-of-digital-soil-mapping" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Fundamentals of Digital Soil Mapping<a href="digital-soil-mapping-and-modeling.html#fundamentals-of-digital-soil-mapping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introduction-to-digital-soil-mapping" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Introduction to Digital Soil Mapping<a href="digital-soil-mapping-and-modeling.html#introduction-to-digital-soil-mapping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Digital soil mapping (DSM) is a modern approach that uses quantitative methods to create soil maps. It combines field observations, laboratory data, and environmental information within a spatial framework <span class="citation">(<a href="#ref-Lagacherie2008">Lagacherie, 2008</a>)</span>. DSM represents a significant change from traditional soil survey, where maps were created based mainly on expert knowledge and manual interpretation of landscapes.</p>
<p>Traditional soil survey relied on a soil surveyor’s conceptual model of the landscape. Surveyors used aerial photographs, satellite images, and field observations to identify soil patterns. However, this approach had important limitations: maps were subjective, difficult to update, and lacked quantitative measures of uncertainty <span class="citation">(<a href="#ref-Minasny2016">Minasny and McBratney, 2016</a>)</span>.</p>
<p>The evolution towards digital methods began in the 1970s when researchers started using computers to store and analyse soil data. <span class="citation">Webster, Lessells and Hodgson (<a href="#ref-Webster1979">1979</a>)</span> demonstrated early digital soil cartography in England, while soil information systems were developed to manage soil databases. During the 1980s, the development of geographic information systems (GIS) and geostatistics provided new tools for spatial analysis. The 1990s brought advances in digital terrain modelling, data mining, and machine learning methods such as classification trees and neural networks.</p>
<p>The success of DSM in the early 2000s resulted from several factors: increased availability of digital elevation models and satellite imagery, greater computing power, development of data mining tools, and a growing global demand for soil information with uncertainty estimates <span class="citation">(<a href="#ref-Minasny2016">Minasny and McBratney, 2016</a>)</span>. Universities and research centres began producing soil maps that were previously only made by national survey agencies.</p>
<p>Today, DSM is defined as the creation of spatial soil information systems using field and laboratory observations combined with spatial inference methods <span class="citation">(<a href="#ref-Lagacherie2006">Lagacherie and McBratney, 2006</a>)</span>. The theoretical framework for DSM was formalised in 2003, establishing the conceptual basis that guides current practice.</p>
</div>
<div id="the-scorpan-framework" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> The SCORPAN Framework<a href="digital-soil-mapping-and-modeling.html#the-scorpan-framework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The conceptual and methodological foundations of DSM were formalised by the <em>scorpan</em> framework <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>. This model represents a quantitative expansion of the classical factors of soil formation originally proposed by Dokuchaev in 1883 and later refined by <span class="citation">Jenny (<a href="#ref-Jenny1941">1941</a>)</span>. While Jenny’s <em>clorpt</em> model (climate, organisms, relief, parent material, time) was developed to explain soil genesis, the <em>scorpan</em> framework transforms this explanatory approach into an empirical predictive tool for spatial mapping.</p>
<p>The fundamental distinction between the two frameworks lies in their purpose. Jenny’s model describes how soils form through the interaction of environmental factors over time—it is a qualitative, theoretical framework. The <em>scorpan</em> approach, in contrast, does not attempt to explain soil formation mechanistically but rather exploits empirical relationships between soil and environmental variables for prediction <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>. As noted by the authors, the direction of causality is not considered: where evidence of a relationship exists, it can be used for prediction regardless of whether the factor causes or is caused by soil properties.</p>
<p>The <em>scorpan</em> acronym identifies seven environmental factors that influence soil distribution:</p>
<ul>
<li><strong>s</strong>: soil—other properties of the soil at a point, including information from prior maps, proximal or remote sensing, or expert knowledge</li>
<li><strong>c</strong>: climate—properties of the environment such as precipitation, temperature, and evapotranspiration</li>
<li><strong>o</strong>: organisms—vegetation, fauna, or human activity, often represented by land cover or spectral indices</li>
<li><strong>r</strong>: relief—topographic attributes derived from digital elevation models</li>
<li><strong>p</strong>: parent material—lithology and geological substrate</li>
<li><strong>a</strong>: age—the time factor representing soil development duration or geomorphic surface age</li>
<li><strong>n</strong>: space—spatial position expressed as geographic coordinates</li>
</ul>
<p>Two additional factors distinguish <em>scorpan</em> from Jenny’s original formulation. First, soil itself (s) is included as a predictor because soil properties can be predicted from other soil attributes measured at the same location or from existing soil maps. Second, the spatial factor (n) explicitly incorporates geographic position, which captures spatial trends and autocorrelation not explained by the other environmental factors <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>. The spatial coordinates can be used directly or transformed into derived variables such as distance to coast or distance from discharge areas.</p>
<p>The general pedometric model is formulated as:</p>
<p><span class="math display">\[S_c = f(s, c, o, r, p, a, n) + \varepsilon\]</span></p>
<p>or for soil attributes:</p>
<p><span class="math display">\[S_a = f(s, c, o, r, p, a, n) + \varepsilon\]</span></p>
<p>This can be expressed more compactly as:</p>
<p><span class="math display">\[S = f(Q) + \varepsilon\]</span></p>
<p>where <span class="math inline">\(S\)</span> denotes a soil class (<span class="math inline">\(S_c\)</span>) or attribute (<span class="math inline">\(S_a\)</span>) at a specific location, <span class="math inline">\(f(Q)\)</span> represents a deterministic function of the <em>scorpan</em> covariates, and <span class="math inline">\(\varepsilon\)</span> represents the spatially autocorrelated residual. The complete methodological approach is termed <em>scorpan-SSPFe</em> (Soil Spatial Prediction Function with spatially autocorrelated errors), where deterministic predictions from <span class="math inline">\(f(Q)\)</span> are complemented by geostatistical modelling of residuals to account for spatial structure not captured by the covariates <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>.</p>
<p>Each <em>scorpan</em> factor is represented by one or more environmental covariates. For example, climate (c) may be represented by mean annual precipitation and temperature; relief (r) by slope, aspect, curvature, and terrain wetness index; and organisms (o) by satellite-derived vegetation indices such as NDVI. The selection of covariates depends on data availability, mapping scale, and the soil property being predicted.</p>
<p>The <em>scorpan-SSPFe</em> approach represents a paradigm shift in soil mapping <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>. While the conventional Jenny model follows a deductive-nomological framework, the <em>scorpan</em> approach follows an inductive-statistical model of explanation. Both frameworks share the same ontological basis—soil as a function of environment—but differ fundamentally in methodology and apparatus. The <em>scorpan</em> approach requires digital data, computing resources, and statistical methods for fitting <span class="math inline">\(f()\)</span>, whereas traditional mapping relies primarily on expert mental models and field interpretation.</p>
</div>
<div id="statistical-theory-for-predictive-soil-mapping" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Statistical Theory for Predictive Soil Mapping<a href="digital-soil-mapping-and-modeling.html#statistical-theory-for-predictive-soil-mapping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The spatial heterogeneity of soil properties results from complex interactions among soil-forming factors that are often only partially characterised. While the deterministic influences of climate, organisms, relief, parent material, and time are well-recognised, their synergistic interaction over pedogenic timescales presents significant challenges for mechanistic modelling <span class="citation">(<a href="#ref-HeuvelinkWebster2001">Heuvelink and Webster, 2001</a>)</span>. Soil varies continuously in space and time, and any description of this variation is inevitably incomplete. Soil scientists must therefore represent this variation using models that combine deterministic and stochastic components <span class="citation">(<a href="#ref-HeuvelinkWebster2001">Heuvelink and Webster, 2001</a>)</span>.</p>
<div id="mechanistic-versus-empirical-approaches" class="section level4 hasAnchor" number="8.1.3.1">
<h4><span class="header-section-number">8.1.3.1</span> Mechanistic versus Empirical Approaches<a href="digital-soil-mapping-and-modeling.html#mechanistic-versus-empirical-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Mechanistic modelling (also referred to as process-based or white-box modelling) involves the mathematical representation of soil systems based on known physical, chemical, and biological processes. Unlike empirical models that rely on statistical correlations, mechanistic models attempt to simulate the actual mechanisms of soil formation and function—such as water movement, solute transport, organic matter decomposition, and soil erosion—over time and space <span class="citation">(<a href="#ref-Wadoux2021">Wadoux, Minasny and McBratney, 2021</a>)</span>. These models typically use systems of differential equations to describe the state of the soil system and its evolution.</p>
<p><span class="citation">Wadoux, Minasny and McBratney (<a href="#ref-Wadoux2021">2021</a>)</span> distinguish between mechanistic and functional (empirical) models for soil mapping. Mechanistic models have structures based on mechanisms derived from knowledge of physical processes and soil chemical and biological reactions. Examples include soil erosion and deposition models, soil-landscape evolution models, and soil carbon dynamics models. However, the main problems with mechanistic approaches are that they require adequate mechanistic understanding of major soil processes, need extensive input data that are often unavailable, have many parameters that are difficult to infer, are computationally challenging, and typically do not quantify prediction uncertainty.</p>
<p>Although advancements have been made in modelling vertical soil variation through process-based approaches, these methods remain primarily experimental and are not yet suitable for large-scale operational soil mapping <span class="citation">(<a href="#ref-Zhang2024">Zhang <em>et al.</em>, 2024</a>)</span>. Consequently, most operational DSM follows an <strong>empirical approach</strong>. Instead of simulating every physical process, empirical models use statistical relationships between soil properties and environmental covariates to make predictions <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>.</p>
<p>Recent research has explored hybrid approaches that integrate process-oriented (PO) and machine learning (ML) models. <span class="citation">Zhang <em>et al.</em> (<a href="#ref-Zhang2024">2024</a>)</span> proposed a framework where PO model outputs serve as additional covariates for ML models, combining the ability of PO models to capture temporal dynamics with the spatial prediction accuracy of ML models. This integration represents a promising avenue for dynamic soil mapping that addresses one of the ten challenges for the future of pedometrics <span class="citation">(<a href="#ref-Wadoux2021">Wadoux, Minasny and McBratney, 2021</a>)</span>.</p>
</div>
<div id="sources-of-residual-variance" class="section level4 hasAnchor" number="8.1.3.2">
<h4><span class="header-section-number">8.1.3.2</span> Sources of Residual Variance<a href="digital-soil-mapping-and-modeling.html#sources-of-residual-variance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Regression models frequently account for only a portion of the total soil variance. This limitation arises from several factors <span class="citation">(<a href="#ref-Hengl2007">Hengl, Heuvelink and Rossiter, 2007</a>; <a href="#ref-Wadoux2021">Wadoux, Minasny and McBratney, 2021</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li><strong>Model structure limitations</strong>: The deterministic model structure may fail to represent actual mechanistic pedogenic processes adequately.</li>
<li><strong>Missing causal factors</strong>: Models often exclude significant causal factors that influence soil variation.</li>
<li><strong>Covariate limitations</strong>: Environmental covariates serve as incomplete proxies for true soil-forming factors (see section below).</li>
<li><strong>Measurement errors</strong>: Covariates contain inherent measurement errors or suffer from scale (support) mismatches relative to soil observations.</li>
<li><strong>Spatial scale effects</strong>: Soil properties vary at spatial scales from the atomic to the global, and the factors causing variation at one scale may differ from those at other scales <span class="citation">(<a href="#ref-Wadoux2021">Wadoux, Minasny and McBratney, 2021</a>)</span>.</li>
</ol>
<p>Given these constraints, soil spatial models often exhibit substantial residual variance. When these residuals demonstrate spatial autocorrelation—quantifiable through variogram analysis—the application of kriging techniques to the residuals can significantly improve prediction accuracy <span class="citation">(<a href="#ref-Hengl2007">Hengl, Heuvelink and Rossiter, 2007</a>; <a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>.</p>
</div>
<div id="covariates-as-proxies-of-soil-forming-factors" class="section level4 hasAnchor" number="8.1.3.3">
<h4><span class="header-section-number">8.1.3.3</span> Covariates as Proxies of Soil-Forming Factors<a href="digital-soil-mapping-and-modeling.html#covariates-as-proxies-of-soil-forming-factors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In DSM, we use the terms <strong>proxy</strong> and <strong>covariate</strong> when referring to environmental data layers used to predict soil properties. A proxy is an indirect measurement of a variable that is difficult to measure directly. Since we cannot measure the exact historical climate or the precise biological activity that has occurred at every location over millennia, we use available data that correlates with these processes <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>.</p>
<p>For example, a <strong>Normalized Difference Vegetation Index (NDVI)</strong> map derived from satellite imagery is not the “organisms” factor itself but serves as a proxy for vegetation biomass and productivity, which influences organic matter inputs to the soil.</p>
<p>While the <em>scorpan</em> framework is based on soil-forming factors, the digital layers we input into models are mathematical representations rather than the physical factors themselves. There are four primary reasons for this distinction <span class="citation">(<a href="#ref-Kempen2009">Kempen <em>et al.</em>, 2009</a>; <a href="#ref-Lagacherie2008">Lagacherie, 2008</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li><strong>Temporal mismatch</strong>: Soil formation occurs over centuries or millennia, but most climate covariates are based on the last 30 to 50 years of data. These represent proxies for the long-term climate that actually formed the soil.</li>
<li><strong>Information loss and simplification</strong>: A Digital Elevation Model represents relief, but it is a grid of numbers representing average heights within pixels. It misses fine-scale terrain nuances that influence water flow and erosion.</li>
<li><strong>Measurement error</strong>: Every digital layer contains inherent errors. Satellite sensors have noise, and climate station data are interpolated across spatial gaps.</li>
<li><strong>Indirect correlation</strong>: Often, a covariate represents multiple factors simultaneously. Elevation (relief) correlates strongly with temperature (climate), making it a statistical surrogate rather than a pure physical factor.</li>
</ol>
</div>
<div id="the-universal-model-of-soil-variation" class="section level4 hasAnchor" number="8.1.3.4">
<h4><span class="header-section-number">8.1.3.4</span> The Universal Model of Soil Variation<a href="digital-soil-mapping-and-modeling.html#the-universal-model-of-soil-variation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In DSM, we mathematically decompose soil variation into distinct components to better understand and predict soil patterns. This decomposition follows the <strong>Universal Model of Soil Variation</strong> <span class="citation">(<a href="#ref-HeuvelinkWebster2001">Heuvelink and Webster, 2001</a>; <a href="#ref-Webster2007">Webster and Oliver, 2007</a>)</span>:</p>
<p><span class="math display">\[Z(s) = m(s) + \varepsilon&#39;(s) + \varepsilon&#39;&#39;(s)\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Z(s)\)</span>: The value of a soil property at a specific location (<span class="math inline">\(s\)</span>)</li>
<li><span class="math inline">\(m(s)\)</span>: The <strong>deterministic component</strong> (trend)—the part of soil variation explained using environmental covariates</li>
<li><span class="math inline">\(\varepsilon&#39;(s)\)</span>: The <strong>spatially correlated stochastic component</strong>—variation that follows a spatial pattern but is not captured by covariates</li>
<li><span class="math inline">\(\varepsilon&#39;&#39;(s)\)</span>: The <strong>pure noise</strong>—measurement errors and fine-scale variation</li>
</ul>
<p>This decomposition provides the theoretical foundation for hybrid interpolation methods such as regression-kriging, where the trend <span class="math inline">\(m(s)\)</span> is modelled as a function of environmental covariates and the spatially correlated residual <span class="math inline">\(\varepsilon&#39;(s)\)</span> is interpolated using kriging <span class="citation">(<a href="#ref-Hengl2007">Hengl, Heuvelink and Rossiter, 2007</a>; <a href="#ref-Odeh1995">Odeh, McBratney and Chittleborough, 1995</a>)</span>.</p>
<p><span class="citation">Hengl, Heuvelink and Rossiter (<a href="#ref-Hengl2007">2007</a>)</span> demonstrated that regression-kriging explicitly separates trend estimation from residual interpolation, allowing the use of arbitrarily complex regression forms. The method can be expressed as:</p>
<p><span class="math display">\[\hat{Z}(s_0) = \hat{m}(s_0) + \hat{\varepsilon}&#39;(s_0)\]</span></p>
<p>where <span class="math inline">\(\hat{m}(s_0)\)</span> is predicted from the regression model and <span class="math inline">\(\hat{\varepsilon}&#39;(s_0)\)</span> is obtained by kriging the regression residuals.</p>
</div>
<div id="extending-the-model-space-depth-and-time-3dt" class="section level4 hasAnchor" number="8.1.3.5">
<h4><span class="header-section-number">8.1.3.5</span> Extending the Model: Space, Depth, and Time (3D+T)<a href="digital-soil-mapping-and-modeling.html#extending-the-model-space-depth-and-time-3dt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>While a 2D map describes soil variation at a single depth layer, soils are three-dimensional bodies that change over time. The Universal Model can be generalised to include depth (<span class="math inline">\(d\)</span>) and time (<span class="math inline">\(t\)</span>) <span class="citation">(<a href="#ref-HeuvelinkWebster2001">Heuvelink and Webster, 2001</a>)</span>:</p>
<p><span class="math display">\[Z(s, d, t) = m(s, d, t) + \varepsilon&#39;(s, d, t) + \varepsilon&#39;&#39;(s, d, t)\]</span></p>
<p>This <strong>3D+T (spatio-temporal)</strong> model allows tracking how soil properties change with depth and evolve over time. <span class="citation">Heuvelink <em>et al.</em> (<a href="#ref-Heuvelink2016">2016</a>)</span> noted that 3D kriging, where depth is treated as a third dimension, has important advantages because predictions at any depth interval can be made. However, modelling vertical variation realistically is challenging due to zonal and geometric anisotropies and discontinuities at horizon boundaries. Soil observations are typically averages over depth intervals and cannot be treated as vertical points. Mass-preserving splines have been developed to address this issue <span class="citation">(<a href="#ref-Bishop1999">Bishop, McBratney and Laslett, 1999</a>; <a href="#ref-Orton2014">Orton <em>et al.</em>, 2014</a>)</span>, though they introduce additional uncertainties.</p>
<div class="Highlights">
<p><strong>Example: Weekly Soil Moisture Mapping</strong>
A classic example of the need for spatio-temporal modelling is <strong>soil moisture</strong>. Unlike soil texture (which changes very slowly over decades), soil moisture fluctuates daily or weekly based on rainfall and evaporation. Creating weekly maps of soil moisture requires a space-time framework considering location (<span class="math inline">\(s\)</span>), time (<span class="math inline">\(t\)</span>), and depth (<span class="math inline">\(d\)</span>) simultaneously.</p>
</div>
<p>However, moving from 2D to 3D+T significantly increases analytical complexity. Each additional dimension requires more model parameters to be estimated, and the data requirements increase substantially.</p>
<blockquote>
<p><strong>2D+T and 3D+T models</strong>: Because data requirements for 2D+T and 3D+T models are high, they remain experimental in many regions. For most projects, focusing on high-quality 2D or 3D (depth-only) mapping is the standard starting point. Recent developments in integrating process-oriented models with machine learning offer promising approaches for capturing temporal dynamics while maintaining spatial prediction accuracy <span class="citation">(<a href="#ref-Zhang2024">Zhang <em>et al.</em>, 2024</a>)</span>.</p>
</blockquote>
</div>
</div>
<div id="types-of-soil-variables" class="section level3 hasAnchor" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Types of Soil Variables<a href="digital-soil-mapping-and-modeling.html#types-of-soil-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Soil variables are classified into two fundamental categories based on their mathematical nature, and this distinction has important implications for the choice of prediction methods <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>:</p>
<p><strong>Continuous Variables (Soil Properties):</strong> These are attributes measured on a numerical scale that can take any value within a range. Common examples include clay content (%), soil organic carbon concentration (g kg⁻¹), pH, bulk density (g cm⁻³), and cation exchange capacity (cmol kg⁻¹). From a pedological perspective, these properties typically change gradually across space, reflecting the continuous nature of soil variation <span class="citation">(<a href="#ref-HeuvelinkWebster2001">Heuvelink and Webster, 2001</a>)</span>. However, some properties may exhibit abrupt changes at lithological boundaries or landscape discontinuities.</p>
<p><strong>Categorical Variables (Soil Classes):</strong> These represent qualitative groups or discrete soil attributes. Examples include soil taxonomic units (e.g., Mollisol, Alfisol), drainage classes, or horizon designations. Traditional soil classification follows a “top-down” model where soils are divided into mutually exclusive classes with sharp conceptual boundaries <span class="citation">(<a href="#ref-Odgers2011">Odgers, McBratney and Minasny, 2011</a>)</span>. However, the intrinsic variability of soil means that soil usually does not exist as discrete bodies with sharp boundaries between them—either physical boundaries in the natural landscape or conceptual boundaries in the feature space <span class="citation">(<a href="#ref-HeuvelinkWebster2001">Heuvelink and Webster, 2001</a>; <a href="#ref-Odgers2011">Odgers, McBratney and Minasny, 2011</a>)</span>.</p>
<p><strong>The Soil Continuum Problem:</strong> In reality, soil grades more or less gradually from one class to another, both in the landscape and in feature space <span class="citation">(<a href="#ref-Odgers2011">Odgers, McBratney and Minasny, 2011</a>)</span>. This has led to the development of continuous classification approaches using fuzzy set theory, where objects can belong to multiple classes with membership values that sum to one <span class="citation">(<a href="#ref-HeuvelinkWebster2001">Heuvelink and Webster, 2001</a>)</span>. Fuzzy classification provides a more realistic representation of soil variation by quantifying the degree of similarity between soil profiles and class centroids.</p>
</div>
<div id="prediction-methods" class="section level3 hasAnchor" number="8.1.5">
<h3><span class="header-section-number">8.1.5</span> Prediction Methods<a href="digital-soil-mapping-and-modeling.html#prediction-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The mathematical nature of soil variables determines the type of statistical method used to create predictive maps <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>:</p>
<p><strong>Regression for Continuous Properties:</strong> For continuous variables, regression algorithms establish numerical relationships between soil properties and environmental covariates. Methods range from linear approaches (ordinary least squares, generalised linear models) to non-linear techniques (generalised additive models, regression trees, neural networks, and ensemble methods such as Random Forest). The advantage of tree-based methods over linear models is their ability to handle nonlinearity and non-additive behaviour without requiring interactions to be pre-specified <span class="citation">(<a href="#ref-Breiman1984">Breiman <em>et al.</em>, 1984</a>; <a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>.</p>
<p><strong>Classification for Soil Classes:</strong> For categorical variables, classification algorithms calculate the probability of a location belonging to specific soil classes. Methods include discriminant analysis, logistic regression, classification trees, and machine learning classifiers. Rather than producing a single “hard” classification, modern approaches often output class membership probabilities for each location, providing a richer representation of prediction uncertainty <span class="citation">(<a href="#ref-Kempen2009">Kempen <em>et al.</em>, 2009</a>; <a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>.</p>
<p><strong>Hybrid Approaches:</strong> Some methods can handle both continuous and categorical data simultaneously. Classification and regression trees (CART) exemplify this flexibility, automatically determining splitting variables and points based on the data structure <span class="citation">(<a href="#ref-Breiman1984">Breiman <em>et al.</em>, 1984</a>)</span>. Tree-based models are particularly valued for their interpretability compared to methods like neural networks or generalised additive models <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>.</p>
</div>
<div id="nonlinearity-and-uncertainty" class="section level3 hasAnchor" number="8.1.6">
<h3><span class="header-section-number">8.1.6</span> Nonlinearity and Uncertainty<a href="digital-soil-mapping-and-modeling.html#nonlinearity-and-uncertainty" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A fundamental characteristic of soil-environment relationships is that they are often <strong>non-linear and complex</strong> <span class="citation">(<a href="#ref-Minasny2016">Minasny and McBratney, 2016</a>)</span>. Environmental factors do not always influence soil properties in simple, linear ways. Terrain attributes may have threshold effects, climate interactions may be multiplicative, and biological processes introduce additional complexity. Because predictive models are simplified representations of natural processes, they are never fully accurate.</p>
<p>Unlike traditional soil maps that provide a single deterministic view, digital soil mapping enables the quantification of <strong>prediction uncertainty</strong>. This means that for every prediction, we can provide measures of confidence indicating where the model is reliable and where additional data might be needed <span class="citation">(<a href="#ref-Padarian2023">Padarian and McBratney, 2023</a>; <a href="#ref-Styc2021">Styc and Lagacherie, 2021</a>)</span>. Uncertainty can be expressed through:</p>
<ul>
<li><strong>Prediction intervals</strong>: Upper and lower bounds within which the true value is expected to fall with a specified probability (e.g., 90% confidence interval)</li>
<li><strong>Standard deviation or variance</strong>: Measures of prediction spread around the mean estimate</li>
<li><strong>Prediction interval coverage probability (PICP)</strong>: Assessment of whether stated confidence intervals actually contain the expected proportion of true values <span class="citation">(<a href="#ref-Styc2021">Styc and Lagacherie, 2021</a>)</span></li>
</ul>
<p>However, <span class="citation">Padarian and McBratney (<a href="#ref-Padarian2023">2023</a>)</span> noted that uncertainty estimates remain underutilised in practice. Around 50% of DSM studies still do not report uncertainty assessments, and end users often find uncertainty maps difficult to interpret alongside target variable maps. This challenge has motivated new approaches for communicating uncertainty, including variable-resolution maps where pixel size encodes prediction confidence.</p>
<hr />
</div>
</div>
<div id="part-ii-practical-application" class="section level2 unnumbered hasAnchor">
<h2>Part II: Practical Application<a href="digital-soil-mapping-and-modeling.html#part-ii-practical-application" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
</div>
<div id="workflow-overview" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Workflow Overview<a href="digital-soil-mapping-and-modeling.html#workflow-overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section guides you through the interpretation of results from the Digital Soil Mapping workflow. We apply the theoretical concepts from Part I to predict three types of soil variables in Kansas, USA, each requiring a different modelling approach:</p>
<table>
<colgroup>
<col width="28%" />
<col width="16%" />
<col width="18%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable type</th>
<th>Example</th>
<th>Approach</th>
<th>What the map shows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Continuous</strong></td>
<td>pH (numeric scale)</td>
<td>Quantile Regression Forest</td>
<td>Predicted value + uncertainty at each pixel</td>
</tr>
<tr class="even">
<td><strong>Nominal</strong></td>
<td>Clay_pH_Class (unordered categories)</td>
<td>Classification Random Forest</td>
<td>Most likely class + class probabilities</td>
</tr>
<tr class="odd">
<td><strong>Ordinal</strong></td>
<td>pH_Class (ordered categories)</td>
<td>Integer-encoded Regression</td>
<td>Predicted class + instability near boundaries</td>
</tr>
</tbody>
</table>
<p>The type of soil variable determines model choice, validation metrics, and how we interpret uncertainty. The workflow also demonstrates the <strong>Area of Applicability (AOA)</strong> analysis to identify where predictions can be trusted.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="digital-soil-mapping-and-modeling.html#cb207-1" tabindex="-1"></a><span class="co"># ── Check and load required packages ──</span></span>
<span id="cb207-2"><a href="digital-soil-mapping-and-modeling.html#cb207-2" tabindex="-1"></a>required_pkgs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;tidyverse&quot;</span>, <span class="st">&quot;caret&quot;</span>, <span class="st">&quot;knitr&quot;</span>)</span>
<span id="cb207-3"><a href="digital-soil-mapping-and-modeling.html#cb207-3" tabindex="-1"></a>missing_pkgs  <span class="ot">&lt;-</span> required_pkgs[<span class="sc">!</span><span class="fu">sapply</span>(required_pkgs, requireNamespace, <span class="at">quietly =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb207-4"><a href="digital-soil-mapping-and-modeling.html#cb207-4" tabindex="-1"></a></span>
<span id="cb207-5"><a href="digital-soil-mapping-and-modeling.html#cb207-5" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(missing_pkgs) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb207-6"><a href="digital-soil-mapping-and-modeling.html#cb207-6" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Installing missing packages: &quot;</span>, <span class="fu">paste</span>(missing_pkgs, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>))</span>
<span id="cb207-7"><a href="digital-soil-mapping-and-modeling.html#cb207-7" tabindex="-1"></a>  <span class="fu">install.packages</span>(missing_pkgs, <span class="at">repos =</span> <span class="st">&quot;https://cloud.r-project.org&quot;</span>)</span>
<span id="cb207-8"><a href="digital-soil-mapping-and-modeling.html#cb207-8" tabindex="-1"></a>}</span>
<span id="cb207-9"><a href="digital-soil-mapping-and-modeling.html#cb207-9" tabindex="-1"></a></span>
<span id="cb207-10"><a href="digital-soil-mapping-and-modeling.html#cb207-10" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb207-11"><a href="digital-soil-mapping-and-modeling.html#cb207-11" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb207-12"><a href="digital-soil-mapping-and-modeling.html#cb207-12" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<hr />
</div>
<div id="continuous-modelling-ph" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Continuous Modelling (pH)<a href="digital-soil-mapping-and-modeling.html#continuous-modelling-ph" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="nature-of-the-variable" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Nature of the Variable<a href="digital-soil-mapping-and-modeling.html#nature-of-the-variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Soil pH is a <strong>continuous variable</strong>: it takes numeric values on a scale (typically 4–9 in mineral soils). We predict the actual pH value at each location rather than placing observations into categories.</p>
<p>Following the <em>scorpan</em> framework, we model pH as a function of environmental covariates that represent climate, organisms, relief, and other soil-forming factors. The relationship is empirical—we do not simulate the chemical processes that determine pH, but rather exploit correlations between pH and measurable environmental variables.</p>
<p><strong>What this approach produces:</strong></p>
<ul>
<li>A map of predicted pH values across the study area</li>
<li>An uncertainty map (standard deviation) showing where predictions are more or less reliable</li>
<li>Validation metrics that measure prediction error in pH units</li>
</ul>
<p><strong>What this approach cannot do:</strong></p>
<ul>
<li>It cannot tell you <em>why</em> pH varies (only which covariates correlate with it)</li>
<li>It does not guarantee accurate predictions in areas unlike the training data</li>
<li>It does not account for temporal changes in pH</li>
</ul>
</div>
<div id="data-and-covariates" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Data and Covariates<a href="digital-soil-mapping-and-modeling.html#data-and-covariates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The workflow begins by loading environmental covariates representing the <em>scorpan</em> factors: terrain attributes derived from digital elevation models (r), climate variables (c), and remote sensing indices representing vegetation (o).</p>
<div class="figure"><span style="display:block;" id="fig:example-covariate"></span>
<img src="images/module5/example_covariate.png" alt="Example environmental covariate layer from the 250m resolution stack." width="1200" />
<p class="caption">
Figure 8.1: Example environmental covariate layer from the 250m resolution stack.
</p>
</div>
<p>Each covariate layer represents one environmental variable at 100m resolution. These are <strong>proxies</strong> for the true soil-forming factors—they correlate with soil pH but do not directly represent the chemical processes involved. The model learns which covariates best explain pH variation from the training points, then applies that relationship to predict pH across the entire area.</p>
</div>
<div id="feature-selection-boruta" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Feature Selection (Boruta)<a href="digital-soil-mapping-and-modeling.html#feature-selection-boruta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Not all covariates contribute equally to prediction. Some may be irrelevant, redundant, or introduce noise. <strong>Boruta</strong> is an algorithm that identifies which covariates genuinely help predict pH by comparing each variable’s importance against randomly shuffled “shadow” versions of itself <span class="citation">(<a href="#ref-Kursa2010">Kursa and Rudnicki, 2010</a>)</span>.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="digital-soil-mapping-and-modeling.html#cb208-1" tabindex="-1"></a>selected_features <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(OUTPUTS_DIR, <span class="st">&quot;models&quot;</span>, <span class="st">&quot;selected_features_pH.rds&quot;</span>))</span>
<span id="cb208-2"><a href="digital-soil-mapping-and-modeling.html#cb208-2" tabindex="-1"></a></span>
<span id="cb208-3"><a href="digital-soil-mapping-and-modeling.html#cb208-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Number of selected features:&quot;</span>, <span class="fu">length</span>(selected_features)))</span></code></pre></div>
<pre><code>## [1] &quot;Number of selected features: 29&quot;</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="digital-soil-mapping-and-modeling.html#cb210-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Selected features:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Selected features:&quot;</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="digital-soil-mapping-and-modeling.html#cb212-1" tabindex="-1"></a><span class="fu">print</span>(selected_features)</span></code></pre></div>
<pre><code>##  [1] &quot;bio1&quot;                  &quot;bio12&quot;                 &quot;bio13&quot;                
##  [4] &quot;bio14&quot;                 &quot;bio16&quot;                 &quot;bio17&quot;                
##  [7] &quot;bio5&quot;                  &quot;bio6&quot;                  &quot;ngd10&quot;                
## [10] &quot;pet_penman_max&quot;        &quot;pet_penman_mean&quot;       &quot;pet_penman_min&quot;       
## [13] &quot;pet_penman_range&quot;      &quot;sfcWind_max&quot;           &quot;sfcWind_mean&quot;         
## [16] &quot;sfcWind_range&quot;         &quot;fpar_030405_500m_mean&quot; &quot;fpar_030405_500m_sd&quot;  
## [19] &quot;fpar_060708_500m_mean&quot; &quot;fpar_060708_500m_sd&quot;   &quot;fpar_091011_500m_mean&quot;
## [22] &quot;fpar_091011_500m_sd&quot;   &quot;fpar_120102_500m_mean&quot; &quot;fpar_120102_500m_sd&quot;  
## [25] &quot;dtm_curvature_250m&quot;    &quot;dtm_elevation_250m&quot;    &quot;dtm_slope_250m&quot;       
## [28] &quot;dtm_tpi_250m&quot;          &quot;dtm_twi_500m&quot;</code></pre>
<div class="figure"><span style="display:block;" id="fig:boruta-plot"></span>
<img src="images/module5/boruta_pH.png" alt="Boruta feature selection results. Green = confirmed important, red = rejected, yellow = tentative." width="442" />
<p class="caption">
Figure 8.2: Boruta feature selection results. Green = confirmed important, red = rejected, yellow = tentative.
</p>
</div>
<p><strong>How to read this plot:</strong></p>
<ul>
<li><strong>Green boxes</strong>: Variables confirmed as important. Their importance exceeds random noise.</li>
<li><strong>Red boxes</strong>: Variables rejected. They do not help more than randomly shuffled data.</li>
<li><strong>Yellow boxes</strong>: Tentative (borderline). We include them to avoid discarding potentially useful information.</li>
</ul>
<p>Check if the selected features make pedological sense. For pH, you might expect climate (precipitation, temperature) and terrain (slope position, wetness) to be important because they influence weathering and drainage.</p>
</div>
<div id="model-training" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Model Training<a href="digital-soil-mapping-and-modeling.html#model-training" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We use <strong>Random Forest</strong> to predict pH. Random Forest is an ensemble method that builds many decision trees, each trained on a random subset of the data, and averages their predictions <span class="citation">(<a href="#ref-Breiman2001">Breiman, 2001</a>)</span>. This approach aligns with the empirical tradition in DSM—we fit the function <span class="math inline">\(f(Q)\)</span> from the <em>scorpan</em> model using data-driven methods rather than process-based equations.</p>
<p><strong>Why Random Forest for DSM:</strong></p>
<ul>
<li>It handles nonlinear relationships between covariates and soil properties automatically</li>
<li>It captures interactions between covariates without requiring explicit specification</li>
<li>It does not require the analyst to specify the functional form of relationships</li>
<li>It provides measures of variable importance for interpretation</li>
</ul>
<p><strong>What Random Forest does NOT solve:</strong></p>
<ul>
<li>It cannot extrapolate beyond the range of covariate values in training data</li>
<li>It does not account for spatial autocorrelation in model fitting (the <span class="math inline">\(\varepsilon&#39;(s)\)</span> term from the Universal Model)</li>
<li>It may underperform if training data are spatially clustered or biased toward certain environments</li>
</ul>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="digital-soil-mapping-and-modeling.html#cb214-1" tabindex="-1"></a>model_cont <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(OUTPUTS_DIR, <span class="st">&quot;models&quot;</span>, <span class="st">&quot;ranger_model_pH.rds&quot;</span>))</span>
<span id="cb214-2"><a href="digital-soil-mapping-and-modeling.html#cb214-2" tabindex="-1"></a></span>
<span id="cb214-3"><a href="digital-soil-mapping-and-modeling.html#cb214-3" tabindex="-1"></a><span class="co"># Show model summary</span></span>
<span id="cb214-4"><a href="digital-soil-mapping-and-modeling.html#cb214-4" tabindex="-1"></a><span class="fu">print</span>(model_cont)</span></code></pre></div>
<pre><code>## Random Forest 
## 
## 424 samples
##  29 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold, repeated 5 times) 
## Summary of sample sizes: 381, 382, 380, 383, 381, 381, ... 
## Resampling results across tuning parameters:
## 
##   mtry  splitrule   RMSE       Rsquared   MAE      
##    5    variance    0.6956261  0.3833561  0.5501236
##    5    extratrees  0.6884646  0.3947113  0.5477938
##   10    variance    0.6980853  0.3798045  0.5522413
##   10    extratrees  0.6883220  0.3947413  0.5471498
##   15    variance    0.6992832  0.3777471  0.5527784
##   15    extratrees  0.6909598  0.3901496  0.5481261
## 
## Tuning parameter &#39;min.node.size&#39; was held constant at a value of 5
## RMSE was used to select the optimal model using the smallest value.
## The final values used for the model were mtry = 10, splitrule = extratrees
##  and min.node.size = 5.</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="digital-soil-mapping-and-modeling.html#cb216-1" tabindex="-1"></a><span class="co"># Best hyperparameters</span></span>
<span id="cb216-2"><a href="digital-soil-mapping-and-modeling.html#cb216-2" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Best hyperparameters:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Best hyperparameters:&quot;</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="digital-soil-mapping-and-modeling.html#cb218-1" tabindex="-1"></a><span class="fu">print</span>(model_cont<span class="sc">$</span>bestTune)</span></code></pre></div>
<pre><code>##   mtry  splitrule min.node.size
## 4   10 extratrees             5</code></pre>
<p>The model was trained using <strong>10-fold cross-validation repeated 5 times</strong>. The data were split into 10 parts; the model was trained on 9 parts and tested on the held-out part, rotating through all combinations. This process was repeated 5 times with different random splits.</p>
<p><strong>What cross-validation evaluates:</strong> How well the model predicts pH for observations not used in training.</p>
<p><strong>What cross-validation does NOT evaluate:</strong> Whether predictions are reliable in geographic areas far from training points. This is a fundamental limitation—cross-validation assumes that held-out observations are representative of prediction locations. If your training points are spatially clustered, the model may perform worse in unsampled regions than cross-validation suggests <span class="citation">(<a href="#ref-Roberts2017">Roberts <em>et al.</em>, 2017</a>)</span>.</p>
</div>
<div id="variable-importance" class="section level3 hasAnchor" number="8.3.5">
<h3><span class="header-section-number">8.3.5</span> Variable Importance<a href="digital-soil-mapping-and-modeling.html#variable-importance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:varimp-plot"></span>
<img src="images/module5/varimp_pH.png" alt="Variable importance from the trained Random Forest model." width="442" />
<p class="caption">
Figure 8.3: Variable importance from the trained Random Forest model.
</p>
</div>
<p>This plot ranks covariates by how much they contribute to predictions. Variables at the top reduce prediction error the most when used in tree splits.</p>
<p>Variable importance helps link empirical predictions back to pedological understanding. If a climate variable ranks highest, soil pH variation may be driven primarily by regional precipitation or temperature gradients. If a terrain variable ranks highest, local topographic position and drainage may dominate. However, importance does not imply causation—it reflects statistical association, not mechanistic influence.</p>
</div>
<div id="validation-metrics" class="section level3 hasAnchor" number="8.3.6">
<h3><span class="header-section-number">8.3.6</span> Validation Metrics<a href="digital-soil-mapping-and-modeling.html#validation-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="digital-soil-mapping-and-modeling.html#cb220-1" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(OUTPUTS_DIR, <span class="st">&quot;validation&quot;</span>, <span class="st">&quot;metrics_pH.csv&quot;</span>), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb220-2"><a href="digital-soil-mapping-and-modeling.html#cb220-2" tabindex="-1"></a><span class="fu">kable</span>(metrics, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">caption =</span> <span class="st">&quot;Cross-validation metrics for pH prediction&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:validation-metrics">Table 8.1: </span>Cross-validation metrics for pH prediction</caption>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">R2</th>
<th align="right">NSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pH</td>
<td align="right">-0.01</td>
<td align="right">0.691</td>
<td align="right">0.383</td>
<td align="right">0.383</td>
</tr>
</tbody>
</table>
<p><strong>What each metric tells you:</strong></p>
<table>
<colgroup>
<col width="24%" />
<col width="27%" />
<col width="48%" />
</colgroup>
<thead>
<tr class="header">
<th>Metric</th>
<th>Meaning</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>ME (Mean Error)</strong></td>
<td>Average difference between predicted and observed.</td>
<td>Values near 0 indicate no systematic bias. Positive ME = model overpredicts on average.</td>
</tr>
<tr class="even">
<td><strong>RMSE</strong></td>
<td>Root Mean Square Error—typical size of prediction errors in pH units.</td>
<td>Compare to the range of pH in your data. RMSE of 0.5 in data ranging 5–8 is different from RMSE of 0.5 in data ranging 6–7.</td>
</tr>
<tr class="odd">
<td><strong>R²</strong></td>
<td>Proportion of variance explained by the model.</td>
<td>R² = 0.32 means the model captures about one-third of pH variation. The remainder is unexplained variance (<span class="math inline">\(\varepsilon&#39;\)</span> and <span class="math inline">\(\varepsilon&#39;&#39;\)</span> from the Universal Model).</td>
</tr>
<tr class="even">
<td><strong>NSE</strong></td>
<td>Nash-Sutcliffe Efficiency.</td>
<td>Values &gt; 0 mean the model is better than simply predicting the mean everywhere.</td>
</tr>
</tbody>
</table>
<p>An R² of ~0.32 is modest but not unusual in DSM. This reflects the sources of residual variance discussed in Part I: measurement error, missing covariates, scale mismatches, and fine-scale soil variation that cannot be captured at 100m resolution.</p>
<div class="figure"><span style="display:block;" id="fig:scatterplot"></span>
<img src="images/module5/scatterplot_pH.png" alt="Observed vs Predicted pH from cross-validation. The red line shows perfect 1:1 prediction." width="708" />
<p class="caption">
Figure 8.4: Observed vs Predicted pH from cross-validation. The red line shows perfect 1:1 prediction.
</p>
</div>
<p><strong>How to read this scatterplot:</strong></p>
<ul>
<li>Points on the red line are perfectly predicted.</li>
<li>Vertical spread around the line shows prediction uncertainty.</li>
<li>If points curve away from the line at high or low values, the model may be compressing extreme predictions toward the mean. This is a common Random Forest behaviour because predictions are averages of tree outputs and cannot exceed the range of training data.</li>
</ul>
</div>
<div id="prediction-maps" class="section level3 hasAnchor" number="8.3.7">
<h3><span class="header-section-number">8.3.7</span> Prediction Maps<a href="digital-soil-mapping-and-modeling.html#prediction-maps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="mean-ph-map" class="section level4 hasAnchor" number="8.3.7.1">
<h4><span class="header-section-number">8.3.7.1</span> Mean pH Map<a href="digital-soil-mapping-and-modeling.html#mean-ph-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-mean"></span>
<img src="images/module5/map_mean_pH.png" alt="Predicted mean pH across the study area." width="1200" />
<p class="caption">
Figure 8.5: Predicted mean pH across the study area.
</p>
</div>
<p>This map represents the deterministic component <span class="math inline">\(\hat{m}(s)\)</span> from the Universal Model—the predicted pH value at each 100m pixel based on environmental covariates.</p>
<p>Look for patterns that match your understanding of soil-landscape relationships. Higher pH in flat, poorly-drained areas may indicate carbonate accumulation. Lower pH on steep slopes may reflect greater leaching. These patterns should be consistent with the <em>scorpan</em> logic: relief influences drainage, which affects weathering and pH.</p>
<p><strong>Warning signs of artefacts:</strong></p>
<ul>
<li>Abrupt straight-line boundaries may indicate covariate artefacts (e.g., satellite image edges, DEM tile boundaries)</li>
<li>Uniform areas with no variation may indicate limited covariate information in those regions</li>
</ul>
</div>
<div id="uncertainty-map-standard-deviation" class="section level4 hasAnchor" number="8.3.7.2">
<h4><span class="header-section-number">8.3.7.2</span> Uncertainty Map (Standard Deviation)<a href="digital-soil-mapping-and-modeling.html#uncertainty-map-standard-deviation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-sd"></span>
<img src="images/module5/map_sd_pH.png" alt="Prediction uncertainty (SD) - higher values indicate more uncertain predictions." width="1200" />
<p class="caption">
Figure 8.6: Prediction uncertainty (SD) - higher values indicate more uncertain predictions.
</p>
</div>
<p>For continuous predictions, we express uncertainty as a <strong>standard deviation (SD)</strong>. This comes from Quantile Regression Forest: each of the trees in the forest makes its own prediction. Where trees agree, SD is low. Where trees disagree, SD is high.</p>
<p>This SD map provides spatially explicit uncertainty—a key advantage of DSM over traditional mapping. High SD areas are where the model is uncertain, often occurring where:</p>
<ul>
<li>Covariate combinations are unlike the training data</li>
<li>Soil patterns are complex or highly variable</li>
<li>Training data are sparse</li>
</ul>
<p>Use this map to prioritise where additional sampling would improve predictions and to communicate confidence to map users.</p>
</div>
<div id="coefficient-of-variation-map" class="section level4 hasAnchor" number="8.3.7.3">
<h4><span class="header-section-number">8.3.7.3</span> Coefficient of Variation Map<a href="digital-soil-mapping-and-modeling.html#coefficient-of-variation-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-cv"></span>
<img src="images/module5/map_cv_pH.png" alt="Coefficient of Variation (%) - relative uncertainty." width="1200" />
<p class="caption">
Figure 8.7: Coefficient of Variation (%) - relative uncertainty.
</p>
</div>
<p>CV expresses uncertainty relative to the predicted value: CV = (SD / Mean) × 100.</p>
<p><strong>Caution:</strong> For pH, CV is meaningful because pH values are never near zero. For variables like soil organic carbon that can approach zero, CV becomes artificially inflated where predicted values are low and should be interpreted carefully.</p>
<hr />
</div>
</div>
</div>
<div id="nominal-classification-clay_ph_class" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Nominal Classification (Clay_pH_Class)<a href="digital-soil-mapping-and-modeling.html#nominal-classification-clay_ph_class" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="nature-of-the-variable-1" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Nature of the Variable<a href="digital-soil-mapping-and-modeling.html#nature-of-the-variable-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Clay_pH_Class</strong> is a <strong>nominal variable</strong>: it consists of unordered categories created by combining clay content classes (low, medium, high) with pH classes (acid, neutral, alkaline). The result is up to 9 combinations like “low_clay_acid” or “high_clay_alkaline”.</p>
<p>These categories have no inherent order. “low_clay_acid” is not “less than” “medium_clay_neutral” in any meaningful sense. This distinguishes nominal from ordinal variables and affects both the model and how we evaluate predictions.</p>
<p><strong>What this approach produces:</strong></p>
<ul>
<li>A map showing the most likely class at each pixel</li>
<li>Probability maps for each class</li>
<li>An uncertainty map based on classification confidence</li>
</ul>
<p><strong>What this approach cannot do:</strong></p>
<ul>
<li>It cannot capture gradual transitions (a pixel is assigned to exactly one class)</li>
<li>It struggles when some classes have few training samples</li>
<li>Accuracy metrics treat all misclassifications equally, whether the error is “neighbouring” or distant in attribute space</li>
</ul>
<p><strong>Important:</strong> Classifying variables that are naturally continuous (like clay content and pH) introduces artificial boundaries. Observations near class thresholds could easily fall into adjacent classes with slightly different measurements—this is the “soil continuum problem” discussed in Part I.</p>
</div>
<div id="feature-selection" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Feature Selection<a href="digital-soil-mapping-and-modeling.html#feature-selection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="digital-soil-mapping-and-modeling.html#cb221-1" tabindex="-1"></a>selected_features_nom <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(OUTPUTS_DIR, <span class="st">&quot;models&quot;</span>, <span class="st">&quot;selected_features_Clay_pH_Class.rds&quot;</span>))</span>
<span id="cb221-2"><a href="digital-soil-mapping-and-modeling.html#cb221-2" tabindex="-1"></a></span>
<span id="cb221-3"><a href="digital-soil-mapping-and-modeling.html#cb221-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Number of selected features:&quot;</span>, <span class="fu">length</span>(selected_features_nom)))</span></code></pre></div>
<pre><code>## [1] &quot;Number of selected features: 28&quot;</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="digital-soil-mapping-and-modeling.html#cb223-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Selected features:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Selected features:&quot;</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="digital-soil-mapping-and-modeling.html#cb225-1" tabindex="-1"></a><span class="fu">print</span>(selected_features_nom)</span></code></pre></div>
<pre><code>##  [1] &quot;bio1&quot;                  &quot;bio12&quot;                 &quot;bio13&quot;                
##  [4] &quot;bio14&quot;                 &quot;bio16&quot;                 &quot;bio17&quot;                
##  [7] &quot;bio5&quot;                  &quot;bio6&quot;                  &quot;ngd10&quot;                
## [10] &quot;pet_penman_max&quot;        &quot;pet_penman_mean&quot;       &quot;pet_penman_min&quot;       
## [13] &quot;pet_penman_range&quot;      &quot;sfcWind_max&quot;           &quot;sfcWind_mean&quot;         
## [16] &quot;sfcWind_range&quot;         &quot;fpar_030405_500m_mean&quot; &quot;fpar_030405_500m_sd&quot;  
## [19] &quot;fpar_060708_500m_mean&quot; &quot;fpar_060708_500m_sd&quot;   &quot;fpar_091011_500m_mean&quot;
## [22] &quot;fpar_091011_500m_sd&quot;   &quot;fpar_120102_500m_mean&quot; &quot;dtm_curvature_250m&quot;   
## [25] &quot;dtm_elevation_250m&quot;    &quot;dtm_slope_250m&quot;        &quot;dtm_tpi_250m&quot;         
## [28] &quot;dtm_twi_500m&quot;</code></pre>
<p>The same Boruta procedure is applied, but now selecting features that help distinguish between soil classes rather than predicting a numeric value.</p>
</div>
<div id="model-training-1" class="section level3 hasAnchor" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> Model Training<a href="digital-soil-mapping-and-modeling.html#model-training-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="digital-soil-mapping-and-modeling.html#cb227-1" tabindex="-1"></a>model_nom <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(OUTPUTS_DIR, <span class="st">&quot;models&quot;</span>, <span class="st">&quot;ranger_model_Clay_pH_Class.rds&quot;</span>))</span>
<span id="cb227-2"><a href="digital-soil-mapping-and-modeling.html#cb227-2" tabindex="-1"></a></span>
<span id="cb227-3"><a href="digital-soil-mapping-and-modeling.html#cb227-3" tabindex="-1"></a><span class="fu">print</span>(model_nom)</span></code></pre></div>
<pre><code>## Random Forest 
## 
## 424 samples
##  28 predictor
##   9 classes: &#39;high_clay_acid&#39;, &#39;high_clay_alkaline&#39;, &#39;high_clay_neutral&#39;, &#39;low_clay_acid&#39;, &#39;low_clay_alkaline&#39;, &#39;low_clay_neutral&#39;, &#39;medium_clay_acid&#39;, &#39;medium_clay_alkaline&#39;, &#39;medium_clay_neutral&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold, repeated 5 times) 
## Summary of sample sizes: 382, 380, 382, 382, 379, 382, ... 
## Resampling results across tuning parameters:
## 
##   mtry  splitrule   Accuracy   Kappa    
##    5    gini        0.4009844  0.2448634
##    5    extratrees  0.4167866  0.2618934
##    9    gini        0.4055288  0.2509430
##    9    extratrees  0.4179784  0.2639396
##   13    gini        0.3972352  0.2421422
##   13    extratrees  0.4065326  0.2513619
## 
## Tuning parameter &#39;min.node.size&#39; was held constant at a value of 5
## Kappa was used to select the optimal model using the largest value.
## The final values used for the model were mtry = 9, splitrule = extratrees
##  and min.node.size = 5.</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="digital-soil-mapping-and-modeling.html#cb229-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Best hyperparameters:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Best hyperparameters:&quot;</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="digital-soil-mapping-and-modeling.html#cb231-1" tabindex="-1"></a><span class="fu">print</span>(model_nom<span class="sc">$</span>bestTune)</span></code></pre></div>
<pre><code>##   mtry  splitrule min.node.size
## 4    9 extratrees             5</code></pre>
<p>For classification, Random Forest assigns each observation to the class that receives the most “votes” from individual trees. Each tree classifies the observation, and the forest aggregates these votes into class probabilities. This provides a form of fuzzy classification—rather than a single hard assignment, we obtain probabilities for each class <span class="citation">(<a href="#ref-McBratney2003">McBratney, Mendonça Santos and Minasny, 2003</a>)</span>.</p>
</div>
<div id="validation" class="section level3 hasAnchor" number="8.4.4">
<h3><span class="header-section-number">8.4.4</span> Validation<a href="digital-soil-mapping-and-modeling.html#validation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="digital-soil-mapping-and-modeling.html#cb233-1" tabindex="-1"></a>metrics_nom <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(OUTPUTS_DIR, <span class="st">&quot;validation&quot;</span>, <span class="st">&quot;metrics_Clay_pH_Class.csv&quot;</span>), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb233-2"><a href="digital-soil-mapping-and-modeling.html#cb233-2" tabindex="-1"></a><span class="fu">kable</span>(metrics_nom, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">caption =</span> <span class="st">&quot;Classification metrics for Clay_pH_Class&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:validation-nominal">Table 8.2: </span>Classification metrics for Clay_pH_Class</caption>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Type</th>
<th align="right">Accuracy</th>
<th align="right">Kappa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Clay_pH_Class</td>
<td align="left">Nominal</td>
<td align="right">0.418</td>
<td align="right">0.264</td>
</tr>
</tbody>
</table>
<p><strong>What each metric tells you:</strong></p>
<table>
<colgroup>
<col width="24%" />
<col width="27%" />
<col width="48%" />
</colgroup>
<thead>
<tr class="header">
<th>Metric</th>
<th>Meaning</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Accuracy</strong></td>
<td>Proportion of observations correctly classified.</td>
<td>With 9 classes, random guessing gives ~11% accuracy. Values above this indicate the model learned meaningful patterns.</td>
</tr>
<tr class="even">
<td><strong>Kappa</strong></td>
<td>Agreement beyond chance, accounting for class frequencies.</td>
<td>Kappa 0.2–0.4 is “fair” agreement; 0.4–0.6 is “moderate”.</td>
</tr>
</tbody>
</table>
<p>Accuracy of ~39% is better than random but limited. This is typical when classifying continuous variables into categories, especially with class imbalance (some classes have many more observations than others).</p>
<div class="figure"><span style="display:block;" id="fig:confusion-matrix"></span>
<img src="images/module5/confusion_matrix_Clay_pH_Class.png" alt="Confusion matrix showing predicted vs observed classes. Diagonal cells are correct predictions." width="1062" />
<p class="caption">
Figure 8.8: Confusion matrix showing predicted vs observed classes. Diagonal cells are correct predictions.
</p>
</div>
<p><strong>How to read the confusion matrix:</strong></p>
<ul>
<li><strong>Diagonal cells</strong> (top-left to bottom-right): Correct predictions. Higher numbers = better.</li>
<li><strong>Off-diagonal cells</strong>: Misclassifications. Look for patterns—which classes are confused with each other?</li>
<li><strong>Empty rows or columns</strong>: Classes with no correct predictions. This indicates the model ignores minority classes, a common problem with imbalanced data.</li>
</ul>
<p>If “high_clay_acid” is often misclassified as “medium_clay_acid”, the model struggles to distinguish clay content but captures pH better. This suggests clay-related covariates may be weaker predictors than pH-related covariates.</p>
</div>
<div id="prediction-maps-1" class="section level3 hasAnchor" number="8.4.5">
<h3><span class="header-section-number">8.4.5</span> Prediction Maps<a href="digital-soil-mapping-and-modeling.html#prediction-maps-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="predicted-class-map" class="section level4 hasAnchor" number="8.4.5.1">
<h4><span class="header-section-number">8.4.5.1</span> Predicted Class Map<a href="digital-soil-mapping-and-modeling.html#predicted-class-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-class-max"></span>
<img src="images/module5/map_class_max_prob.png" alt="Predicted class based on maximum probability." width="1200" />
<p class="caption">
Figure 8.9: Predicted class based on maximum probability.
</p>
</div>
<p>Each pixel is assigned to the class with the highest predicted probability. Check if spatial patterns match landscape expectations: high clay in floodplains? Acid soils in high-rainfall uplands?</p>
</div>
<div id="maximum-probability-map" class="section level4 hasAnchor" number="8.4.5.2">
<h4><span class="header-section-number">8.4.5.2</span> Maximum Probability Map<a href="digital-soil-mapping-and-modeling.html#maximum-probability-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-prob-max"></span>
<img src="images/module5/map_max_prob_value.png" alt="Maximum class probability - higher values indicate more confident predictions." width="1200" />
<p class="caption">
Figure 8.10: Maximum class probability - higher values indicate more confident predictions.
</p>
</div>
<p><strong>Why probability is uncertainty for nominal variables:</strong></p>
<p>For classification, the model outputs a probability for each class. These probabilities reflect the votes from individual trees. If the maximum probability is 0.9, the model is confident—most trees agree. If it is 0.2 (close to 1/9 = 0.11 for random guessing with 9 classes), the model is uncertain—trees disagree about which class applies.</p>
<p>Low probability areas are “transition zones” where the model cannot confidently assign a single class. These often correspond to gradual soil transitions in the landscape—precisely the areas where the categorical representation is most problematic.</p>
</div>
<div id="uncertainty-map" class="section level4 hasAnchor" number="8.4.5.3">
<h4><span class="header-section-number">8.4.5.3</span> Uncertainty Map<a href="digital-soil-mapping-and-modeling.html#uncertainty-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-uncertainty-nom"></span>
<img src="images/module5/map_uncertainty_nominal.png" alt="Classification uncertainty (1 - max probability)." width="1200" />
<p class="caption">
Figure 8.11: Classification uncertainty (1 - max probability).
</p>
</div>
<p>This map shows 1 minus the maximum probability. High values mean the model is uncertain about class assignment.</p>
</div>
<div id="confident-predictions-map" class="section level4 hasAnchor" number="8.4.5.4">
<h4><span class="header-section-number">8.4.5.4</span> Confident Predictions Map<a href="digital-soil-mapping-and-modeling.html#confident-predictions-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-confident"></span>
<img src="images/module5/map_class_confident.png" alt="Only predictions where max probability &gt;= 0.4 are shown." width="1200" />
<p class="caption">
Figure 8.12: Only predictions where max probability &gt;= 0.4 are shown.
</p>
</div>
<p>This map applies a confidence threshold: predictions below 40% probability are masked. Areas in white/NA are where the model is not confident enough to assign a class.</p>
<p>When delivering classification maps to users, consider providing probability maps alongside class maps, or masking uncertain areas to avoid false precision.</p>
<hr />
</div>
</div>
</div>
<div id="ordinal-modelling-ph_class" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Ordinal Modelling (pH_Class)<a href="digital-soil-mapping-and-modeling.html#ordinal-modelling-ph_class" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="nature-of-the-variable-2" class="section level3 hasAnchor" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Nature of the Variable<a href="digital-soil-mapping-and-modeling.html#nature-of-the-variable-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>pH_Class</strong> is an <strong>ordinal variable</strong>: categories with a natural order. The levels are: very_acid &lt; acid &lt; neutral &lt; alkaline &lt; very_alkaline.</p>
<p>Unlike nominal classes, order matters. Predicting “acid” when the truth is “neutral” (one class away) is a smaller error than predicting “very_acid” (two classes away). This ordering changes how we validate predictions and interpret errors.</p>
<p><strong>What this approach produces:</strong></p>
<ul>
<li>A map of predicted pH classes</li>
<li>An instability map showing where predictions are near class boundaries</li>
<li>Validation metrics that account for class order (distance-weighted errors)</li>
</ul>
<p><strong>What this approach cannot do:</strong></p>
<ul>
<li>It assumes equal spacing between classes (the “distance” from very_acid to acid equals acid to neutral), which may not reflect true chemical differences</li>
<li>It does not preserve the original continuous pH information</li>
</ul>
</div>
<div id="ordinal-encoding" class="section level3 hasAnchor" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> Ordinal Encoding<a href="digital-soil-mapping-and-modeling.html#ordinal-encoding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="digital-soil-mapping-and-modeling.html#cb234-1" tabindex="-1"></a>ordinal_encoding <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(OUTPUTS_DIR, <span class="st">&quot;models&quot;</span>, <span class="st">&quot;ordinal_encoding.rds&quot;</span>))</span>
<span id="cb234-2"><a href="digital-soil-mapping-and-modeling.html#cb234-2" tabindex="-1"></a></span>
<span id="cb234-3"><a href="digital-soil-mapping-and-modeling.html#cb234-3" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Ordinal level lookup:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Ordinal level lookup:&quot;</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="digital-soil-mapping-and-modeling.html#cb236-1" tabindex="-1"></a><span class="fu">print</span>(ordinal_encoding<span class="sc">$</span>lookup)</span></code></pre></div>
<pre><code>##           level integer
## 1     very_acid       1
## 2          acid       2
## 3       neutral       3
## 4      alkaline       4
## 5 very_alkaline       5</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="digital-soil-mapping-and-modeling.html#cb238-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Reclassification thresholds:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Reclassification thresholds:&quot;</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="digital-soil-mapping-and-modeling.html#cb240-1" tabindex="-1"></a><span class="fu">print</span>(ordinal_encoding<span class="sc">$</span>reclassify_matrix)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p><strong>The approach:</strong></p>
<ol style="list-style-type: decimal">
<li>Convert ordered classes to integers: very_acid = 1, acid = 2, neutral = 3, alkaline = 4, very_alkaline = 5</li>
<li>Train a regression model to predict these integers as if they were continuous</li>
<li>Round predictions back to classes using midpoint thresholds (1.5, 2.5, 3.5, 4.5)</li>
</ol>
<p><strong>Limitation:</strong> This assumes equal spacing between classes. In reality, the chemical difference between pH 4 and 5 may not equal the difference between pH 6 and 7. The ordinal approach is a compromise between continuous prediction and nominal classification.</p>
</div>
<div id="feature-selection-1" class="section level3 hasAnchor" number="8.5.3">
<h3><span class="header-section-number">8.5.3</span> Feature Selection<a href="digital-soil-mapping-and-modeling.html#feature-selection-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="digital-soil-mapping-and-modeling.html#cb242-1" tabindex="-1"></a>selected_features_ord <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(OUTPUTS_DIR, <span class="st">&quot;models&quot;</span>, <span class="st">&quot;selected_features_pH_Class.rds&quot;</span>))</span>
<span id="cb242-2"><a href="digital-soil-mapping-and-modeling.html#cb242-2" tabindex="-1"></a></span>
<span id="cb242-3"><a href="digital-soil-mapping-and-modeling.html#cb242-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Number of selected features:&quot;</span>, <span class="fu">length</span>(selected_features_ord)))</span></code></pre></div>
<pre><code>## [1] &quot;Number of selected features: 29&quot;</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="digital-soil-mapping-and-modeling.html#cb244-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Selected features:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Selected features:&quot;</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="digital-soil-mapping-and-modeling.html#cb246-1" tabindex="-1"></a><span class="fu">print</span>(selected_features_ord)</span></code></pre></div>
<pre><code>##  [1] &quot;bio1&quot;                  &quot;bio12&quot;                 &quot;bio13&quot;                
##  [4] &quot;bio14&quot;                 &quot;bio16&quot;                 &quot;bio17&quot;                
##  [7] &quot;bio5&quot;                  &quot;bio6&quot;                  &quot;ngd10&quot;                
## [10] &quot;pet_penman_max&quot;        &quot;pet_penman_mean&quot;       &quot;pet_penman_min&quot;       
## [13] &quot;pet_penman_range&quot;      &quot;sfcWind_max&quot;           &quot;sfcWind_mean&quot;         
## [16] &quot;sfcWind_range&quot;         &quot;fpar_030405_500m_mean&quot; &quot;fpar_030405_500m_sd&quot;  
## [19] &quot;fpar_060708_500m_mean&quot; &quot;fpar_060708_500m_sd&quot;   &quot;fpar_091011_500m_mean&quot;
## [22] &quot;fpar_091011_500m_sd&quot;   &quot;fpar_120102_500m_mean&quot; &quot;fpar_120102_500m_sd&quot;  
## [25] &quot;dtm_curvature_250m&quot;    &quot;dtm_elevation_250m&quot;    &quot;dtm_slope_250m&quot;       
## [28] &quot;dtm_tpi_250m&quot;          &quot;dtm_twi_500m&quot;</code></pre>
</div>
<div id="model-training-2" class="section level3 hasAnchor" number="8.5.4">
<h3><span class="header-section-number">8.5.4</span> Model Training<a href="digital-soil-mapping-and-modeling.html#model-training-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="digital-soil-mapping-and-modeling.html#cb248-1" tabindex="-1"></a>model_ord <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(OUTPUTS_DIR, <span class="st">&quot;models&quot;</span>, <span class="st">&quot;ranger_model_pH_Class_ordinal.rds&quot;</span>))</span>
<span id="cb248-2"><a href="digital-soil-mapping-and-modeling.html#cb248-2" tabindex="-1"></a></span>
<span id="cb248-3"><a href="digital-soil-mapping-and-modeling.html#cb248-3" tabindex="-1"></a><span class="fu">print</span>(model_ord)</span></code></pre></div>
<pre><code>## Random Forest 
## 
## 424 samples
##  29 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold, repeated 5 times) 
## Summary of sample sizes: 382, 382, 380, 382, 382, 380, ... 
## Resampling results across tuning parameters:
## 
##   mtry  splitrule   RMSE       Rsquared   MAE      
##    5    variance    0.7677947  0.3509020  0.6090019
##    5    extratrees  0.7595814  0.3613039  0.6040114
##   10    variance    0.7712644  0.3465458  0.6116310
##   10    extratrees  0.7595455  0.3619105  0.6033011
##   15    variance    0.7716605  0.3469278  0.6122184
##   15    extratrees  0.7631243  0.3569775  0.6059889
## 
## Tuning parameter &#39;min.node.size&#39; was held constant at a value of 5
## RMSE was used to select the optimal model using the smallest value.
## The final values used for the model were mtry = 10, splitrule = extratrees
##  and min.node.size = 5.</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="digital-soil-mapping-and-modeling.html#cb250-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Best hyperparameters:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Best hyperparameters:&quot;</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="digital-soil-mapping-and-modeling.html#cb252-1" tabindex="-1"></a><span class="fu">print</span>(model_ord<span class="sc">$</span>bestTune)</span></code></pre></div>
<pre><code>##   mtry  splitrule min.node.size
## 4   10 extratrees             5</code></pre>
<p>We use Random Forest in regression mode, treating the integer-coded classes as a continuous target. This allows the model to produce predictions like 2.7, which is then rounded to class 3 (neutral). The regression approach respects the ordering of classes—predicting 2.7 is closer to truth=3 than predicting 1.2.</p>
</div>
<div id="validation-1" class="section level3 hasAnchor" number="8.5.5">
<h3><span class="header-section-number">8.5.5</span> Validation<a href="digital-soil-mapping-and-modeling.html#validation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="digital-soil-mapping-and-modeling.html#cb254-1" tabindex="-1"></a>metrics_ord <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(OUTPUTS_DIR, <span class="st">&quot;validation&quot;</span>, <span class="st">&quot;metrics_pH_Class_ordinal.csv&quot;</span>), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb254-2"><a href="digital-soil-mapping-and-modeling.html#cb254-2" tabindex="-1"></a><span class="fu">kable</span>(metrics_ord, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">caption =</span> <span class="st">&quot;Ordinal classification metrics for pH_Class&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:validation-ordinal">Table 8.3: </span>Ordinal classification metrics for pH_Class</caption>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Type</th>
<th align="right">MAE_rank</th>
<th align="right">Mean_distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pH_Class</td>
<td align="left">Ordinal</td>
<td align="right">0.554</td>
<td align="right">0.554</td>
</tr>
</tbody>
</table>
<p><strong>What each metric tells you:</strong></p>
<table>
<colgroup>
<col width="24%" />
<col width="27%" />
<col width="48%" />
</colgroup>
<thead>
<tr class="header">
<th>Metric</th>
<th>Meaning</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>MAE_rank</strong></td>
<td>Mean Absolute Error in class units—average distance between observed and predicted class.</td>
<td>MAE_rank = 0.58 means predictions are typically about half a class off.</td>
</tr>
<tr class="even">
<td><strong>Mean_distance</strong></td>
<td>Weighted average error accounting for all misclassifications.</td>
<td>Lower values = predictions closer to truth on the ordinal scale.</td>
</tr>
</tbody>
</table>
<p><strong>Why ordinal metrics differ from nominal:</strong></p>
<p>In ordinal validation, not all errors are equal. Predicting class 3 when truth is class 4 (distance = 1) is less severe than predicting class 1 (distance = 3). The metrics weight errors by their distance on the ordinal scale.</p>
<div class="figure"><span style="display:block;" id="fig:ordinal-confusion"></span>
<img src="images/module5/ordinal_confusion_pH_Class.png" alt="Ordinal confusion matrix. Errors near the diagonal are minor; errors far from diagonal are severe." width="886" />
<p class="caption">
Figure 8.13: Ordinal confusion matrix. Errors near the diagonal are minor; errors far from diagonal are severe.
</p>
</div>
<p><strong>How to read the ordinal confusion matrix:</strong></p>
<ul>
<li><strong>Diagonal</strong>: Correct predictions</li>
<li><strong>Adjacent cells (±1)</strong>: Minor errors, one class off</li>
<li><strong>Distant cells</strong>: Severe errors, multiple classes off</li>
<li>Look for systematic patterns: does the model consistently underpredict (errors below diagonal) or overpredict (errors above diagonal)?</li>
</ul>
</div>
<div id="prediction-maps-2" class="section level3 hasAnchor" number="8.5.6">
<h3><span class="header-section-number">8.5.6</span> Prediction Maps<a href="digital-soil-mapping-and-modeling.html#prediction-maps-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="latent-values-map" class="section level4 hasAnchor" number="8.5.6.1">
<h4><span class="header-section-number">8.5.6.1</span> Latent Values Map<a href="digital-soil-mapping-and-modeling.html#latent-values-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-latent"></span>
<img src="images/module5/map_latent_pH_Class.png" alt="Continuous 'latent' predictions before reclassification to ordinal classes." width="1200" />
<p class="caption">
Figure 8.14: Continuous ‘latent’ predictions before reclassification to ordinal classes.
</p>
</div>
<p>This map shows the raw regression output before rounding to classes. Values range from ~1 to ~5. This reveals continuous spatial gradients that are lost when we assign discrete classes.</p>
</div>
<div id="reclassified-ordinal-class-map" class="section level4 hasAnchor" number="8.5.6.2">
<h4><span class="header-section-number">8.5.6.2</span> Reclassified Ordinal Class Map<a href="digital-soil-mapping-and-modeling.html#reclassified-ordinal-class-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-class-ord"></span>
<img src="images/module5/map_class_pH_Class.png" alt="Ordinal classes derived from latent predictions using midpoint thresholds." width="1200" />
<p class="caption">
Figure 8.15: Ordinal classes derived from latent predictions using midpoint thresholds.
</p>
</div>
<p>Classes 1–5 correspond to: very_acid, acid, neutral, alkaline, very_alkaline. Compare this to the continuous pH map—patterns should be similar but expressed as discrete classes.</p>
</div>
<div id="standard-deviation-map" class="section level4 hasAnchor" number="8.5.6.3">
<h4><span class="header-section-number">8.5.6.3</span> Standard Deviation Map<a href="digital-soil-mapping-and-modeling.html#standard-deviation-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-sd-ord"></span>
<img src="images/module5/map_sd_pH_Class.png" alt="Prediction uncertainty (SD) from the ordinal regression model." width="1200" />
<p class="caption">
Figure 8.16: Prediction uncertainty (SD) from the ordinal regression model.
</p>
</div>
<p>As with continuous predictions, SD reflects disagreement among trees. High SD means the model is uncertain about the latent value.</p>
</div>
<div id="class-instability-map" class="section level4 hasAnchor" number="8.5.6.4">
<h4><span class="header-section-number">8.5.6.4</span> Class Instability Map<a href="digital-soil-mapping-and-modeling.html#class-instability-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:map-instability"></span>
<img src="images/module5/map_instability_pH_Class.png" alt="Class instability - high values where predictions are near class boundaries." width="1200" />
<p class="caption">
Figure 8.17: Class instability - high values where predictions are near class boundaries.
</p>
</div>
<p><strong>Why ordinal uncertainty is about instability:</strong></p>
<p>For ordinal variables, a unique source of uncertainty is <strong>class boundary instability</strong>. A prediction of 2.48 is very close to the 2.5 threshold between classes 2 and 3. Small changes in input data or model parameters could flip the assigned class.</p>
<p>Instability combines prediction uncertainty (SD) with proximity to class boundaries. High instability means: “The model predicts a value near a threshold AND is uncertain about that value.”</p>
<p>Areas with high instability should be flagged as uncertain classifications, even if they receive a class label in the map. This is a form of uncertainty specific to ordinal classification that does not exist for continuous predictions.</p>
<hr />
</div>
</div>
</div>
<div id="area-of-applicability-aoa" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Area of Applicability (AOA)<a href="digital-soil-mapping-and-modeling.html#area-of-applicability-aoa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="why-aoa-is-necessary" class="section level3 hasAnchor" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Why AOA is Necessary<a href="digital-soil-mapping-and-modeling.html#why-aoa-is-necessary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cross-validation tells us how well the model predicts <strong>where we have training data</strong>. But we apply the model to the entire study area, including locations with covariate combinations unlike any training point.</p>
<p>This relates to a fundamental limitation of empirical models: they cannot extrapolate reliably beyond the range of training data. The <em>scorpan</em> model <span class="math inline">\(S = f(Q) + \varepsilon\)</span> is fitted using available observations, and predictions outside the training domain are unreliable.</p>
<p>The <strong>Area of Applicability (AOA)</strong> identifies which parts of the study area have covariate combinations similar to the training data <span class="citation">(<a href="#ref-Meyer2021">Meyer and Pebesma, 2021</a>)</span>. Outside the AOA, the model is extrapolating, and predictions may be unreliable regardless of cross-validation performance.</p>
</div>
<div id="dissimilarity-index-di" class="section level3 hasAnchor" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> Dissimilarity Index (DI)<a href="digital-soil-mapping-and-modeling.html#dissimilarity-index-di" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:map-di"></span>
<img src="images/module5/map_DI_pH.png" alt="Dissimilarity Index - how different each location is from training data in covariate space." width="1200" />
<p class="caption">
Figure 8.18: Dissimilarity Index - how different each location is from training data in covariate space.
</p>
</div>
<p>DI measures how different each pixel’s covariate values are from the nearest training point in multivariate covariate space. It is calculated using weighted Euclidean distance, where weights reflect variable importance from the model.</p>
<p>DI near 0 means the pixel is similar to training data. High DI means the covariate combination was not well represented in training—the model is extrapolating.</p>
</div>
<div id="aoa-binary-mask" class="section level3 hasAnchor" number="8.6.3">
<h3><span class="header-section-number">8.6.3</span> AOA Binary Mask<a href="digital-soil-mapping-and-modeling.html#aoa-binary-mask" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:map-aoa-mask"></span>
<img src="images/module5/map_AOA_pH.png" alt="Area of Applicability mask. Green = within AOA (trustworthy), Grey = outside AOA (unreliable)." width="1200" />
<p class="caption">
Figure 8.19: Area of Applicability mask. Green = within AOA (trustworthy), Grey = outside AOA (unreliable).
</p>
</div>
<p>Pixels are classified as inside (1) or outside (0) the AOA based on a DI threshold derived from cross-validation.</p>
<ul>
<li><strong>Green areas</strong>: Model has seen similar covariate combinations. Predictions are supported by training data.</li>
<li><strong>Grey areas</strong>: Covariate combinations not represented in training. Predictions are extrapolations and should not be trusted.</li>
</ul>
<pre><code>## AOA coverage: 91.5 % of study area</code></pre>
</div>
<div id="local-point-density-lpd" class="section level3 hasAnchor" number="8.6.4">
<h3><span class="header-section-number">8.6.4</span> Local Point Density (LPD)<a href="digital-soil-mapping-and-modeling.html#local-point-density-lpd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:map-lpd"></span>
<img src="images/module5/map_LPD_pH.png" alt="Local Point Density - number of training points supporting predictions at each location." width="1200" />
<p class="caption">
Figure 8.20: Local Point Density - number of training points supporting predictions at each location.
</p>
</div>
<p>LPD counts how many training points are “nearby” in covariate space. Even within the AOA, some areas have more training support than others.</p>
<p>LPD = 0 means no training points are nearby—a strong warning. Higher LPD means multiple training observations support the prediction, increasing confidence.</p>
</div>
<div id="predictions-masked-to-aoa" class="section level3 hasAnchor" number="8.6.5">
<h3><span class="header-section-number">8.6.5</span> Predictions Masked to AOA<a href="digital-soil-mapping-and-modeling.html#predictions-masked-to-aoa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:map-masked-aoa"></span>
<img src="images/module5/map_mean_pH_masked_AOA.png" alt="pH predictions only shown within the Area of Applicability." width="1200" />
<p class="caption">
Figure 8.21: pH predictions only shown within the Area of Applicability.
</p>
</div>
<p>This map shows predictions only where the model can be trusted. White/NA areas are outside the AOA.</p>
<p><strong>Practical recommendations:</strong></p>
<ol style="list-style-type: decimal">
<li>Always report AOA coverage alongside prediction maps</li>
<li>Mask or flag predictions outside AOA when delivering products to users</li>
<li>Use areas outside AOA to prioritise future sampling—these are gaps in training data coverage</li>
</ol>
<hr />
</div>
</div>
<div id="summary" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Summary<a href="digital-soil-mapping-and-modeling.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table>
<colgroup>
<col width="14%" />
<col width="23%" />
<col width="15%" />
<col width="18%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th>Session</th>
<th>Variable Type</th>
<th>Approach</th>
<th>Key Metric</th>
<th>Uncertainty Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Continuous (pH)</td>
<td>QRF regression</td>
<td>R², RMSE</td>
<td>Standard deviation from tree disagreement</td>
</tr>
<tr class="even">
<td>2</td>
<td>Nominal (Clay_pH_Class)</td>
<td>Classification RF</td>
<td>Accuracy, Kappa</td>
<td>Probability of assigned class</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Ordinal (pH_Class)</td>
<td>Integer regression</td>
<td>MAE_rank</td>
<td>Instability near class boundaries</td>
</tr>
<tr class="even">
<td>4</td>
<td>AOA</td>
<td>Dissimilarity analysis</td>
<td>Coverage %</td>
<td>Inside/outside applicability</td>
</tr>
</tbody>
</table>
<p><strong>Key points:</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>Match the model to the variable type.</strong> Continuous, nominal, and ordinal variables require different approaches and produce different outputs. The choice follows from the mathematical nature of the variable and how errors should be evaluated.</p></li>
<li><p><strong>Models are empirical, not mechanistic.</strong> We fit statistical relationships between soil and covariates (<span class="math inline">\(S = f(Q) + \varepsilon\)</span>) rather than simulating physical processes. This is powerful but limited—models cannot explain causation or extrapolate reliably.</p></li>
<li><p><strong>Cross-validation has limits.</strong> It evaluates prediction at training locations, not in unsampled areas. Spatial clustering of training data can lead to overly optimistic error estimates.</p></li>
<li><p><strong>Always report uncertainty.</strong> The form of uncertainty depends on variable type: standard deviation for continuous variables, class probabilities for nominal variables, and instability for ordinal variables.</p></li>
<li><p><strong>Use AOA to identify reliable predictions.</strong> Do not trust predictions in areas with covariate combinations unlike the training data.</p></li>
</ol>
<hr />
</div>
<div id="references-1" class="section level2 unnumbered hasAnchor">
<h2>References<a href="digital-soil-mapping-and-modeling.html#references-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body" entry-spacing="0">
<div id="ref-Bishop1999" class="csl-entry">
<strong>Bishop, T.F.A., McBratney, A.B. &amp; Laslett, G.M.</strong> 1999. Modelling soil attribute depth functions with equal-area quadratic smoothing splines, 91: 27–45. <a href="https://doi.org/10.1016/s0016-7061(99)00003-8">https://doi.org/10.1016/s0016-7061(99)00003-8</a>
</div>
<div id="ref-Breiman2001" class="csl-entry">
<strong>Breiman, L.</strong> 2001. Random forests. <em>Machine Learning</em>, 45(1): 5–32. <a href="https://doi.org/10.1023/A:1010933404324">https://doi.org/10.1023/A:1010933404324</a>
</div>
<div id="ref-Breiman1984" class="csl-entry">
<strong>Breiman, L., Friedman, J.H., Olshen, R.A. &amp; Stone, C.J.</strong> 1984. <em>Classification and regression trees</em>. Belmont, CA, Wadsworth.
</div>
<div id="ref-Hengl2007" class="csl-entry">
<strong>Hengl, T., Heuvelink, G.B.M. &amp; Rossiter, D.G.</strong> 2007. About regression-kriging: From equations to case studies. <em>Computers &amp; Geosciences</em>, 33: 1301–1315. <a href="https://doi.org/10.1016/j.cageo.2007.05.001">https://doi.org/10.1016/j.cageo.2007.05.001</a>
</div>
<div id="ref-Heuvelink2016" class="csl-entry">
<strong>Heuvelink, G.B.M., Kros, J., Reinds, G.J. &amp; De Vries, W.</strong> 2016. Geostatistical prediction and simulation of european soil property maps. <em>Geoderma Regional</em>, 7: 201–215. <a href="https://doi.org/10.1016/j.geodrs.2016.04.002">https://doi.org/10.1016/j.geodrs.2016.04.002</a>
</div>
<div id="ref-HeuvelinkWebster2001" class="csl-entry">
<strong>Heuvelink, G.B.M. &amp; Webster, R.</strong> 2001. Modelling soil variation: Past, present, and future. <em>Geoderma</em>, 100: 269–301. <a href="https://doi.org/10.1016/S0016-7061(01)00025-8">https://doi.org/10.1016/S0016-7061(01)00025-8</a>
</div>
<div id="ref-Jenny1941" class="csl-entry">
<strong>Jenny, H.</strong> 1941. A system of quantitative pedology. In <span>“factors of soil formation”</span>. McGraw Hill: New York.
</div>
<div id="ref-Kempen2009" class="csl-entry">
<strong>Kempen, B., Brus, D.J., Heuvelink, G.B.M. &amp; Stoorvogel, J.J.</strong> 2009. Updating the 1:50,000 dutch soil map using legacy soil data: A multinomial logistic regression approach. <em>Geoderma</em>, 151: 311–326. <a href="https://doi.org/10.1016/j.geoderma.2009.04.023">https://doi.org/10.1016/j.geoderma.2009.04.023</a>
</div>
<div id="ref-Kursa2010" class="csl-entry">
<strong>Kursa, M.B. &amp; Rudnicki, W.R.</strong> 2010. Feature selection with the <span>Boruta</span> package. <em>Journal of Statistical Software</em>, 36(11): 1–13. <a href="https://doi.org/10.18637/jss.v036.i11">https://doi.org/10.18637/jss.v036.i11</a>
</div>
<div id="ref-Lagacherie2008" class="csl-entry">
<strong>Lagacherie, P.</strong> 2008. Digital soil mapping: A state of the art. <em>In</em> A.E. Hartemink, A.B. McBratney &amp; M.L. Mendonça-Santos, eds. <em>Digital soil mapping with limited data</em>, pp. 3–14. Dordrecht, Springer.
</div>
<div id="ref-Lagacherie2006" class="csl-entry">
<strong>Lagacherie, P. &amp; McBratney, A.B.</strong> 2006. Spatial soil information systems and spatial soil inference systems: Perspectives for digital soil mapping. <em>In</em> P. Lagacherie, A.B. McBratney &amp; M. Voltz, eds. <em>Digital soil mapping: An introductory perspective</em>, pp. 3–22. Amsterdam, Elsevier.
</div>
<div id="ref-McBratney2003" class="csl-entry">
<strong>McBratney, A.B., Mendonça Santos, M.L. &amp; Minasny, B.</strong> 2003. On digital soil mapping. <em>Geoderma</em>, 117: 3–52. <a href="https://doi.org/10.1016/S0016-7061(03)00223-4">https://doi.org/10.1016/S0016-7061(03)00223-4</a>
</div>
<div id="ref-Meyer2021" class="csl-entry">
<strong>Meyer, H. &amp; Pebesma, E.</strong> 2021. Predicting into unknown space? <span>E</span>stimating the area of applicability of spatial prediction models. <em>Methods in Ecology and Evolution</em>, 12: 1620–1633. <a href="https://doi.org/10.1111/2041-210X.13650">https://doi.org/10.1111/2041-210X.13650</a>
</div>
<div id="ref-Minasny2016" class="csl-entry">
<strong>Minasny, B. &amp; McBratney, A.B.</strong> 2016. Digital soil mapping: A brief history and some lessons. <em>Geoderma</em>, 264: 301–311. <a href="https://doi.org/10.1016/j.geoderma.2015.07.017">https://doi.org/10.1016/j.geoderma.2015.07.017</a>
</div>
<div id="ref-Odeh1995" class="csl-entry">
<strong>Odeh, I.O.A., McBratney, A.B. &amp; Chittleborough, D.J.</strong> 1995. Further results on prediction of soil properties from terrain attributes: Heterotopic cokriging and regression-kriging. <em>Geoderma</em>, 67: 215–226. <a href="https://doi.org/10.1016/0016-7061(95)00007-B">https://doi.org/10.1016/0016-7061(95)00007-B</a>
</div>
<div id="ref-Odgers2011" class="csl-entry">
<strong>Odgers, N.P., McBratney, A.B. &amp; Minasny, B.</strong> 2011. Bottom-up digital soil mapping. <span>I</span>. <span>S</span>oil layer classes. <em>Geoderma</em>, 163: 38–44. <a href="https://doi.org/10.1016/j.geoderma.2011.03.014">https://doi.org/10.1016/j.geoderma.2011.03.014</a>
</div>
<div id="ref-Orton2014" class="csl-entry">
<strong>Orton, T.G., Pringle, M.J., Page, K.L., Dalal, R.C. &amp; Bishop, T.F.A.</strong> 2014. Spatial prediction of soil organic carbon stock using a linear model of coregionalisation. <em>Geoderma</em>, 230–231: 119–130. <a href="https://doi.org/10.1016/j.geoderma.2014.04.016">https://doi.org/10.1016/j.geoderma.2014.04.016</a>
</div>
<div id="ref-Padarian2023" class="csl-entry">
<strong>Padarian, J. &amp; McBratney, A.B.</strong> 2023. <span>QuadMap</span>: Variable resolution maps to communicate uncertainty. <em>Computers and Geosciences</em>, 181: 105480. <a href="https://doi.org/10.1016/j.cageo.2023.105480">https://doi.org/10.1016/j.cageo.2023.105480</a>
</div>
<div id="ref-Roberts2017" class="csl-entry">
<strong>Roberts, D.R. &amp; others</strong>. 2017. Cross-validation strategies for data with temporal, spatial, hierarchical, or phylogenetic structure. <em>Ecography</em>, 40: 913–929. <a href="https://doi.org/10.1111/ecog.02881">https://doi.org/10.1111/ecog.02881</a>
</div>
<div id="ref-Styc2021" class="csl-entry">
<strong>Styc, Q. &amp; Lagacherie, P.</strong> 2021. Combining spatial-environmental covariates and soil input data types to predict soil available water holding capacity. <em>Geoderma</em>, 401: 115171. <a href="https://doi.org/10.1016/j.geoderma.2021.115171">https://doi.org/10.1016/j.geoderma.2021.115171</a>
</div>
<div id="ref-Wadoux2021" class="csl-entry">
<strong>Wadoux, A.M.J.-C., Minasny, B. &amp; McBratney, A.B.</strong> 2021. Machine learning for digital soil mapping: Applications, challenges and suggested solutions. <em>Earth-Science Reviews</em>, 210: 103359. <a href="https://doi.org/10.1016/j.earscirev.2020.103359">https://doi.org/10.1016/j.earscirev.2020.103359</a>
</div>
<div id="ref-Webster1979" class="csl-entry">
<strong>Webster, R., Lessells, C.M. &amp; Hodgson, J.M.</strong> 1979. A reconnaissance soil survey of the ivybridge area of south devon. <em>Soil Survey Technical Monograph</em>, 12.
</div>
<div id="ref-Webster2007" class="csl-entry">
<strong>Webster, R. &amp; Oliver, M.A.</strong> 2007. <em>Geostatistics for environmental scientists</em>. 2nd edition. Chichester, John Wiley &amp; Sons.
</div>
<div id="ref-Zhang2024" class="csl-entry">
<strong>Zhang, L., Heuvelink, G.B.M., Mulder, V.L., Chen, S., Deng, X. &amp; Yang, L.</strong> 2024. Using process-oriented model output to enhance machine learning-based soil organic carbon prediction in space and time. <em>Science of the Total Environment</em>, 922: 170778. <a href="https://doi.org/10.1016/j.scitotenv.2024.170778">https://doi.org/10.1016/j.scitotenv.2024.170778</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="glosis-soil-data-preparation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="soil-data-sharing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": {},
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  },
  "fig_caption": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
